(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     61830,       1479]
NotebookOptionsPosition[     58882,       1438]
NotebookOutlinePosition[     59281,       1454]
CellTagsIndexPosition[     59238,       1451]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"quiccroot", "=", 
   RowBox[{
   "$HomeDirectory", "<>", 
    "\"\</Documents/QuICC/build/QuICC_aquad/serial\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$MaxExtraPrecision", "=", "1000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mpprec", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"unitSpectrum", "[", 
    RowBox[{"n_", ",", "maxN_", ",", "m_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"n", "<=", " ", "maxN"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", "==", "0"}], ",", "1", ",", 
       RowBox[{"(", " ", 
        RowBox[{"1", "-", "\[ImaginaryI]"}], ")"}]}], "]"}], ",", " ", "0"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"maxSpectrum", "[", 
    RowBox[{"n_", ",", "maxN_", ",", "m_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"n", "==", "maxN"}], ",", 
     RowBox[{"(", 
      RowBox[{"1", "-", "\[ImaginaryI]"}], ")"}], ",", "0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"minSpectrum", "[", 
    RowBox[{"n_", ",", "maxN_", ",", "m_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"n", "==", "0"}], ",", "1", ",", "0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fftP", "[", "s_", "]"}], ":=", "s"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fftD1", "[", "s_", "]"}], ":=", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"i", "-", "1"}], ")"}], "\[ImaginaryI]"}], ")"}], " ", 
      RowBox[{"s", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{
        RowBox[{"Dimensions", "[", "s", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{
        RowBox[{"Dimensions", "[", "s", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"intgD1", "[", "s_", "]"}], ":=", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"i", "-", "1"}], ")"}], "\[ImaginaryI]"}], ")"}], " ", 
      RowBox[{"s", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{
        RowBox[{"Dimensions", "[", "s", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{
        RowBox[{"Dimensions", "[", "s", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"intgD1P", "[", "s_", "]"}], ":=", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"i", "-", "1"}], " ", "==", " ", "0"}], ",", " ", 
       RowBox[{"s", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"i", "-", "1"}], ")"}], "\[ImaginaryI]"}], ")"}], " ", 
        RowBox[{"s", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{
        RowBox[{"Dimensions", "[", "s", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{
        RowBox[{"Dimensions", "[", "s", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"intgD1Neg", "[", "s_", "]"}], ":=", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"i", "-", "1"}], " ", "==", " ", "0"}], ",", " ", 
       RowBox[{"-", 
        RowBox[{"s", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"i", "-", "1"}], ")"}], "\[ImaginaryI]"}], ")"}], " ", 
        RowBox[{"s", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{
        RowBox[{"Dimensions", "[", "s", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{
        RowBox[{"Dimensions", "[", "s", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fftD2", "[", "s_", "]"}], ":=", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"i", "-", "1"}], ")"}], "\[ImaginaryI]"}], ")"}], "2"], " ", 
      RowBox[{"s", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{
        RowBox[{"Dimensions", "[", "s", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{
        RowBox[{"Dimensions", "[", "s", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fftD3", "[", "s_", "]"}], ":=", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"i", "-", "1"}], ")"}], "\[ImaginaryI]"}], ")"}], "3"], " ", 
      RowBox[{"s", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{
        RowBox[{"Dimensions", "[", "s", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{
        RowBox[{"Dimensions", "[", "s", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fftD4", "[", "s_", "]"}], ":=", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"i", "-", "1"}], ")"}], "\[ImaginaryI]"}], ")"}], "4"], " ", 
      RowBox[{"s", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{
        RowBox[{"Dimensions", "[", "s", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{
        RowBox[{"Dimensions", "[", "s", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dealiasMixed", "[", "n_", "]"}], ":=", 
   RowBox[{"Ceiling", "[", 
    RowBox[{"3", "n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dataroot", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{
      "quiccroot", ",", "\"\<Components\>\"", ",", "\"\<Transform\>\"", ",", 
       "\"\<TestSuite\>\""}], "}"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"datadir", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<_data\>\"", ",", "\"\<Transform\>\"", ",", "\"\<Fourier\>\"", ",", 
     "\"\<Mixed\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"refdir", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<_refdata\>\"", ",", "\"\<Transform\>\"", ",", "\"\<Fourier\>\"", 
     ",", "\"\<Mixed\>\""}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.848543632437368*^9, 3.848543652984336*^9}, {
   3.848546689424226*^9, 3.8485467201781483`*^9}, {3.848546753533717*^9, 
   3.848546760261607*^9}, {3.84854686963389*^9, 3.848546876744934*^9}, {
   3.84854693265998*^9, 3.848546933726007*^9}, {3.8485483310989532`*^9, 
   3.8485483376956787`*^9}, {3.8485512475351763`*^9, 
   3.8485512564338207`*^9}, {3.84855128854653*^9, 3.848551288844084*^9}, {
   3.848551732914913*^9, 3.848551765342298*^9}, {3.8485518026661243`*^9, 
   3.848551810179921*^9}, {3.848551843718082*^9, 3.848551962355454*^9}, {
   3.8485520558381233`*^9, 3.848552102443151*^9}, {3.8485522712175283`*^9, 
   3.848552274575116*^9}, {3.8485533328269367`*^9, 3.84855334011436*^9}, {
   3.84855881158141*^9, 3.848558850530476*^9}, {3.8487110354013*^9, 
   3.848711051169693*^9}, {3.848711094678115*^9, 3.8487110965318613`*^9}, {
   3.848711163602653*^9, 3.8487111700286303`*^9}, {3.8487123173789053`*^9, 
   3.8487123425338497`*^9}, {3.848712411379739*^9, 3.84871241516501*^9}, {
   3.8487125109430857`*^9, 3.848712531710004*^9}, {3.851043731654964*^9, 
   3.851043732423477*^9}, {3.856884460898674*^9, 3.856884461602518*^9}, {
   3.856932204305873*^9, 3.856932225701264*^9}, {3.882953978142939*^9, 
   3.882953981749894*^9}, 3.884331628664546*^9, {3.885275759691217*^9, 
   3.885275761554892*^9}, 3.8852758459529877`*^9, 3.885284458018965*^9, {
   3.895189828224547*^9, 3.895189829584097*^9}, {3.8951899971435966`*^9, 
   3.895190020555071*^9}, {3.89519007785632*^9, 3.8951900871820507`*^9}, {
   3.896346857663423*^9, 3.8963468582800207`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"5cfe7242-35d0-4108-bf14-5f6315b84ca8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"testProjector", "[", 
    RowBox[{
    "meta_", ",", "id_", ",", "infunc_", ",", "opfunc_", ",", "name_"}], 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"outprec", " ", "=", " ", "32"}], ",", "i", ",", "nN", ",", 
       "maxN", ",", "gridN", ",", "ks", ",", "descr", ",", " ", "spec", ",", 
       "specFft", ",", "grid", ",", "phys", ",", "inData", ",", "refData", 
       ",", "msg", ",", "tempmsg", ",", "fbase", ",", "fname"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nN", "=", 
       RowBox[{"meta", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"maxN", "=", 
       RowBox[{"nN", "-", "1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gridN", " ", "=", " ", 
       RowBox[{"meta", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ks", "=", 
       RowBox[{"meta", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"spec", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"N", "[", 
          RowBox[{
           RowBox[{"infunc", "[", 
            RowBox[{
             RowBox[{"i", "-", "1"}], ",", "maxN", ",", 
             RowBox[{"ks", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", "mpprec"}], "]"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nN"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "@", "ks"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"inData", " ", "=", " ", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Re", "[", "spec", "]"}], ",", 
         RowBox[{"Im", "[", "spec", "]"}]}], "]"}]}], ";", 
      RowBox[{"msg", "=", 
       RowBox[{
       "\"\<Exporting \>\"", "<>", "name", "<>", 
        "\"\< Fourier operator for N = \>\"", "<>", 
        RowBox[{"ToString", "[", "maxN", "]"}], "<>", "\"\<, Ng = \>\"", " ", 
        "<>", 
        RowBox[{"ToString", "[", "gridN", "]"}], "<>", "\"\<, m = \>\"", "<>", 
        RowBox[{"ToString", "[", "ks", "]"}], "<>", "\"\<...\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"spec", "=", 
       RowBox[{"opfunc", "[", "spec", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"specFft", "=", 
       RowBox[{"PadRight", "[", 
        RowBox[{"spec", ",", 
         RowBox[{"{", 
          RowBox[{"gridN", ",", 
           RowBox[{"Length", "@", "ks"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"specFft", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"nN", "-", "1"}], ")"}]}], ";;"}], ",", ";;"}], "]"}], 
        "]"}], " ", "=", " ", 
       RowBox[{"Reverse", "[", 
        RowBox[{"Conjugate", "[", 
         RowBox[{"specFft", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"2", ";;", "nN"}], ",", ";;"}], "]"}], "]"}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"phys", "=", 
       RowBox[{"ParallelTable", "[", 
        RowBox[{
         RowBox[{"Re", "[", 
          RowBox[{"InverseFourier", "[", 
           RowBox[{
            RowBox[{"specFft", "[", 
             RowBox[{"[", 
              RowBox[{";;", ",", "j"}], "]"}], "]"}], ",", 
            RowBox[{"FourierParameters", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", 
               RowBox[{"-", "1"}]}], "}"}]}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "@", "ks"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"refData", " ", "=", 
       RowBox[{"N", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", "phys", "]"}], ",", "outprec"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"fbase", "=", 
       RowBox[{"name", "<>", "\"\<_id\>\"", "<>", 
        RowBox[{"ToString", "[", "id", "]"}]}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"fname", "=", 
       RowBox[{"fbase", "<>", "\"\<_meta.dat\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"descr", "=", 
       RowBox[{"Flatten", "[", "meta", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"descr", " ", "=", " ", 
       RowBox[{"Prepend", "[", 
        RowBox[{"descr", ",", 
         RowBox[{"Length", "@", "descr"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{"dataroot", ",", "refdir", ",", "fname"}], "}"}], "]"}], 
         "]"}], ",", "descr"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"fname", "=", 
       RowBox[{"fbase", "<>", "\"\<_in.dat\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{"dataroot", ",", "refdir", ",", "fname"}], "}"}], "]"}], 
         "]"}], ",", "inData", ",", "\"\<Table\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fname", "=", 
       RowBox[{"fbase", "<>", "\"\<_ref.dat\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{"dataroot", ",", "refdir", ",", "fname"}], "}"}], "]"}], 
         "]"}], ",", "refData", ",", "\"\<Table\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"Row", "[", 
        RowBox[{"{", 
         RowBox[{"msg", ",", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"\"\< Done(\>\"", "<>", 
             RowBox[{"DateString", "[", "]"}], "<>", "\"\<)\>\""}], ",", 
            RowBox[{"FontColor", "\[Rule]", "Green"}]}], "]"}]}], "}"}], 
        "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.848544082531231*^9, 3.8485441206159887`*^9}, {
   3.848544199470216*^9, 3.848544202531197*^9}, {3.8485442419673758`*^9, 
   3.8485442841474247`*^9}, {3.8485443158079443`*^9, 3.848544379452045*^9}, {
   3.848544491944911*^9, 3.848544503082264*^9}, {3.84854690348077*^9, 
   3.848546946436736*^9}, {3.848548282022455*^9, 3.8485482826431026`*^9}, {
   3.8485488440489492`*^9, 3.848548845407783*^9}, {3.848548923972725*^9, 
   3.848548926086543*^9}, 3.848549004725293*^9, {3.848549042151484*^9, 
   3.848549060158608*^9}, {3.8485492080664463`*^9, 3.848549218216367*^9}, {
   3.848549336659297*^9, 3.84854934256061*^9}, 3.8485494057905493`*^9, {
   3.848549495000537*^9, 3.848549507847514*^9}, {3.8485497230519943`*^9, 
   3.848549760434679*^9}, {3.848549794194234*^9, 3.848549881917148*^9}, {
   3.848549933607978*^9, 3.8485499337645597`*^9}, {3.84855004852782*^9, 
   3.848550085828267*^9}, {3.8485502386027718`*^9, 3.848550263153633*^9}, {
   3.848550299617405*^9, 3.848550326746565*^9}, {3.848550388207848*^9, 
   3.848550395894126*^9}, {3.848550438001481*^9, 3.848550452380403*^9}, {
   3.848550484309864*^9, 3.848550492040352*^9}, {3.84855053626206*^9, 
   3.84855053777932*^9}, {3.848550637170566*^9, 3.84855065640476*^9}, 
   3.848550731974621*^9, {3.84855108595995*^9, 3.8485510862573357`*^9}, {
   3.848551348739162*^9, 3.8485513720404863`*^9}, {3.848551704484617*^9, 
   3.848551707018684*^9}, {3.8485517815033083`*^9, 3.848551797939369*^9}, {
   3.848552167777462*^9, 3.848552168616691*^9}, {3.848711183791305*^9, 
   3.848711263046679*^9}, {3.84871131754592*^9, 3.848711433844955*^9}, {
   3.8510437471348677`*^9, 3.8510437610936937`*^9}, {3.856884404215345*^9, 
   3.856884419364176*^9}, 3.856931763376588*^9},
 CellLabel->"In[89]:=",ExpressionUUID->"9a715d2e-661b-4abf-a363-ca916e311d73"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"generateProjectors", "[", 
    RowBox[{"meta_", ",", "tId_", ",", "inOp_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "subdir", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"subdir", " ", "=", " ", "\"\<Projector/\>\""}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"testProjector", "[", 
       RowBox[{"meta", ",", "tId", ",", "inOp", ",", "fftP", ",", 
        RowBox[{"subdir", "<>", "\"\<P\>\""}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"testProjector", "[", 
       RowBox[{"meta", ",", "tId", ",", "inOp", ",", "fftD1", ",", 
        RowBox[{"subdir", "<>", "\"\<D1\>\""}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"testProjector", "[", 
       RowBox[{"meta", ",", "tId", ",", "inOp", ",", "fftD2", ",", 
        RowBox[{"subdir", "<>", "\"\<D2\>\""}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"testProjector", "[", 
       RowBox[{"meta", ",", "tId", ",", "inOp", ",", "fftD3", ",", 
        RowBox[{"subdir", "<>", "\"\<D3\>\""}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"testProjector", "[", 
       RowBox[{"meta", ",", "tId", ",", "inOp", ",", "fftD4", ",", 
        RowBox[{"subdir", "<>", "\"\<D4\>\""}]}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8480417499460173`*^9, 3.848041751710577*^9}, {
   3.848041917107429*^9, 3.848042069705041*^9}, {3.848042104298834*^9, 
   3.8480421047567987`*^9}, {3.8480519574942636`*^9, 3.848052001991641*^9}, {
   3.8484765440263453`*^9, 3.8484765633816566`*^9}, {3.848476611045773*^9, 
   3.8484766837044353`*^9}, {3.84847672349049*^9, 3.848476882622653*^9}, {
   3.848476985943591*^9, 3.848476988641829*^9}, {3.848477122141608*^9, 
   3.848477146295006*^9}, {3.84847753185931*^9, 3.8484775362079144`*^9}, {
   3.848477961302064*^9, 3.8484779657515182`*^9}, 3.848478012527858*^9, {
   3.8485441404093246`*^9, 3.848544183371348*^9}, {3.84854439308457*^9, 
   3.848544393404928*^9}, {3.8485516721532793`*^9, 3.848551686143037*^9}, {
   3.848551969847752*^9, 3.848551983965369*^9}, {3.848553309987952*^9, 
   3.848553317775674*^9}, {3.848553367145294*^9, 3.848553386582819*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"a56f9f9c-0f76-4cd2-b0f4-f3d48a7183f1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"generateProjectors", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"10", ",", 
      RowBox[{"dealiasMixed", "[", "10", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}], ",", "0", ",", 
    "minSpectrum"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.848477163759015*^9, 3.848477163938704*^9}, {
  3.848544186916778*^9, 3.848544187240117*^9}, {3.848546886656233*^9, 
  3.8485468872569017`*^9}, {3.8568844297613707`*^9, 3.8568844333068132`*^9}, {
  3.856931800761879*^9, 3.856931801467412*^9}, {3.85693248780525*^9, 
  3.856932489091346*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"2ab4f447-f7f2-40e6-b941-4202f5e4e819"],

Cell[BoxData[
 RowBox[{
  RowBox[{"generateProjectors", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"10", ",", 
      RowBox[{"dealiasMixed", "[", "10", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}], ",", "1", ",", 
    "maxSpectrum"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.848477604857543*^9, 3.848477613519485*^9}, {
   3.848544188566922*^9, 3.8485441888901176`*^9}, {3.8485468916319857`*^9, 
   3.848546892273322*^9}, 3.856884437807288*^9},
 CellLabel->"In[91]:=",ExpressionUUID->"9740f07b-a703-4899-9202-375f720751c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"generateProjectors", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"10", ",", 
      RowBox[{"dealiasMixed", "[", "10", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}], ",", "2", ",", 
    "unitSpectrum"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.848477608787516*^9, 3.84847761962344*^9}, {
   3.8485441933401527`*^9, 3.8485441938038883`*^9}, {3.848546895036005*^9, 
   3.8485468954955597`*^9}, {3.8485520076838837`*^9, 
   3.8485520088603153`*^9}, {3.848559623031475*^9, 3.8485596242899933`*^9}, 
   3.8568844391801767`*^9, 3.882954199576948*^9, {3.895189888179706*^9, 
   3.895189926195754*^9}, 3.895190111407146*^9},
 CellLabel->"In[96]:=",ExpressionUUID->"125bbac1-ae90-43c8-b15d-e47c5f5c0406"],

Cell[BoxData[
 RowBox[{
  RowBox[{"generateProjectors", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"25", ",", 
      RowBox[{"dealiasMixed", "[", "25", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}], ",", "3", ",", 
    "unitSpectrum"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.848477608787516*^9, 3.84847761962344*^9}, {
   3.8485441933401527`*^9, 3.8485441938038883`*^9}, {3.848546895036005*^9, 
   3.8485468954955597`*^9}, {3.8485520076838837`*^9, 
   3.8485520088603153`*^9}, {3.848559623031475*^9, 3.8485596242899933`*^9}, 
   3.8568844391801767`*^9, 3.882954199576948*^9, {3.895189888179706*^9, 
   3.895189926195754*^9}, {3.895190111407146*^9, 3.8951901149501057`*^9}, {
   3.895190254095667*^9, 3.89519025659966*^9}},
 CellLabel->
  "In[108]:=",ExpressionUUID->"4075eb96-b413-4398-bf2f-e1d56fba6bc5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"generateProjectors", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"85", ",", 
      RowBox[{"dealiasMixed", "[", "85", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}], ",", "4", ",", 
    "unitSpectrum"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.848477608787516*^9, 3.84847761962344*^9}, {
   3.8485441933401527`*^9, 3.8485441938038883`*^9}, {3.848546895036005*^9, 
   3.8485468954955597`*^9}, {3.8485520076838837`*^9, 
   3.8485520088603153`*^9}, {3.848559623031475*^9, 3.8485596242899933`*^9}, 
   3.8568844391801767`*^9, 3.882954199576948*^9, {3.895189888179706*^9, 
   3.895189926195754*^9}, {3.895190111407146*^9, 3.8951901149501057`*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"56ddd12e-658e-4d4f-915a-75beb73a0d53"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"For", "[", " ", 
   RowBox[{
    RowBox[{"p", " ", "=", " ", "7"}], ",", 
    RowBox[{"p", "<", "10"}], ",", 
    RowBox[{"p", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nM", "=", 
      SuperscriptBox["2", "p"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nG", " ", "=", 
      RowBox[{"dealiasMixed", "[", "nM", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"meta", "=", 
      RowBox[{"{", 
       RowBox[{"nM", ",", "nG", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"m", ",", 
          RowBox[{"{", 
           RowBox[{"m", ",", "0", ",", 
            RowBox[{"nM", "-", "1"}]}], "}"}]}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"generateProjectors", "[", 
      RowBox[{"meta", ",", 
       RowBox[{"100", "+", "p"}], ",", "unitSpectrum"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Clear", "[", "nM", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Clear", "[", "nG", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Clear", "[", "meta", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "p", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8829543199218693`*^9, 3.88295434144726*^9}, {
  3.8829549132787037`*^9, 3.882954994380485*^9}, {3.8829576609446363`*^9, 
  3.8829576612799587`*^9}, {3.8829581497604837`*^9, 
  3.882958150124611*^9}},ExpressionUUID->"89b2fa86-7552-4152-94cd-\
a9bd7ecaa4f9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"testIntegrator", "[", 
    RowBox[{
    "meta_", ",", "id_", ",", "infunc_", ",", "opfunc_", ",", "name_"}], 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"outprec", " ", "=", " ", "32"}], ",", "i", ",", "nN", ",", 
       "maxN", ",", "gridN", ",", "ks", ",", "descr", ",", "spec", ",", 
       "specFft", ",", "phys", ",", "grid", ",", "inData", ",", "refData", 
       ",", "msg", ",", "tempmsg", ",", "fbase", ",", "fname"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nN", "=", 
       RowBox[{"meta", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"maxN", "=", 
       RowBox[{"nN", "-", "1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gridN", " ", "=", " ", 
       RowBox[{"meta", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ks", "=", 
       RowBox[{"meta", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"spec", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"N", "[", 
          RowBox[{
           RowBox[{"infunc", "[", 
            RowBox[{
             RowBox[{"i", "-", "1"}], ",", "maxN", ",", 
             RowBox[{"ks", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", "mpprec"}], "]"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nN"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "@", "ks"}]}], "}"}]}], "]"}]}], ";", 
      RowBox[{"msg", "=", 
       RowBox[{
       "\"\<Exporting \>\"", "<>", "name", "<>", 
        "\"\< Fourier operator for N = \>\"", "<>", 
        RowBox[{"ToString", "[", "maxN", "]"}], "<>", "\"\<, Ng = \>\"", " ", 
        "<>", 
        RowBox[{"ToString", "[", "gridN", "]"}], "<>", "\"\<, m = \>\"", "<>", 
        RowBox[{"ToString", "[", "ks", "]"}], "<>", "\"\<...\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"specFft", " ", "=", "spec"}], ";", "\[IndentingNewLine]", 
      RowBox[{"spec", "=", 
       RowBox[{"opfunc", "[", "spec", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"refData", " ", "=", " ", 
       RowBox[{"N", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Re", "[", "spec", "]"}], ",", 
           RowBox[{"Im", "[", "spec", "]"}]}], "]"}], ",", "outprec"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"specFft", "=", 
       RowBox[{"PadRight", "[", 
        RowBox[{"specFft", ",", 
         RowBox[{"{", 
          RowBox[{"gridN", ",", 
           RowBox[{"Length", "@", "ks"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"specFft", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"nN", "-", "1"}], ")"}]}], ";;"}], ",", ";;"}], "]"}], 
        "]"}], " ", "=", " ", 
       RowBox[{"Reverse", "[", 
        RowBox[{"Conjugate", "[", 
         RowBox[{"specFft", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"2", ";;", "nN"}], ",", ";;"}], "]"}], "]"}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"phys", "=", 
       RowBox[{"ParallelTable", "[", 
        RowBox[{
         RowBox[{"Re", "[", 
          RowBox[{"InverseFourier", "[", 
           RowBox[{
            RowBox[{"specFft", "[", 
             RowBox[{"[", 
              RowBox[{";;", ",", "j"}], "]"}], "]"}], ",", 
            RowBox[{"FourierParameters", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", 
               RowBox[{"-", "1"}]}], "}"}]}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "@", "ks"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"inData", " ", "=", 
       RowBox[{"N", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", "phys", "]"}], ",", "outprec"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"fbase", "=", 
       RowBox[{"name", "<>", "\"\<_id\>\"", "<>", 
        RowBox[{"ToString", "[", "id", "]"}]}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"fname", "=", 
       RowBox[{"fbase", "<>", "\"\<_meta.dat\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"descr", "=", 
       RowBox[{"Flatten", "[", "meta", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"descr", " ", "=", " ", 
       RowBox[{"Prepend", "[", 
        RowBox[{"descr", ",", 
         RowBox[{"Length", "@", "descr"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{"dataroot", ",", "refdir", ",", "fname"}], "}"}], "]"}], 
         "]"}], ",", "descr"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"fname", "=", 
       RowBox[{"fbase", "<>", "\"\<_in.dat\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{"dataroot", ",", "refdir", ",", "fname"}], "}"}], "]"}], 
         "]"}], ",", "inData", ",", "\"\<Table\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fname", "=", 
       RowBox[{"fbase", "<>", "\"\<_ref.dat\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{"dataroot", ",", "refdir", ",", "fname"}], "}"}], "]"}], 
         "]"}], ",", "refData", ",", "\"\<Table\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"Row", "[", 
        RowBox[{"{", 
         RowBox[{"msg", ",", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"\"\< Done(\>\"", "<>", 
             RowBox[{"DateString", "[", "]"}], "<>", "\"\<)\>\""}], ",", 
            RowBox[{"FontColor", "\[Rule]", "Green"}]}], "]"}]}], "}"}], 
        "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.8485530897757483`*^9, 3.848553090866639*^9}, {
   3.848553445810137*^9, 3.848553448730844*^9}, {3.848554977403105*^9, 
   3.848555006824006*^9}, {3.848555044229909*^9, 3.848555142302926*^9}, {
   3.848555248420541*^9, 3.848555299214982*^9}, {3.848555378201633*^9, 
   3.848555379102296*^9}, {3.848555442779606*^9, 3.848555443257875*^9}, {
   3.848711575501134*^9, 3.8487116963741913`*^9}, {3.8487117468473663`*^9, 
   3.848711755549405*^9}, {3.848711907499666*^9, 3.848712072842929*^9}, {
   3.848712267874296*^9, 3.848712269123591*^9}, {3.8487123061656513`*^9, 
   3.848712309064699*^9}, {3.848712436724243*^9, 3.848712438697494*^9}, {
   3.851043813051713*^9, 3.8510438283412*^9}, {3.8568845708116627`*^9, 
   3.856884577984329*^9}, {3.856932992701679*^9, 3.8569329963476353`*^9}, 
   3.856933186551654*^9, {3.856933640865546*^9, 3.856933643219034*^9}, 
   3.856933742652082*^9, 3.856933968666232*^9, {3.856934150646989*^9, 
   3.856934193842272*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"3431dbbf-d06e-40e6-82e0-698201dea67c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"generateIntegrators", "[", 
    RowBox[{"meta_", ",", "tId_", ",", "inOp_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "subdir", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"subdir", " ", "=", " ", "\"\<Integrator/\>\""}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"testIntegrator", "[", 
       RowBox[{"meta", ",", "tId", ",", "inOp", ",", "fftP", ",", 
        RowBox[{"subdir", "<>", "\"\<P\>\""}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"testIntegrator", "[", 
       RowBox[{"meta", ",", "tId", ",", "inOp", ",", "intgD1", ",", 
        RowBox[{"subdir", "<>", "\"\<D1\>\""}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"testIntegrator", "[", 
       RowBox[{"meta", ",", "tId", ",", "inOp", ",", "intgD1Neg", ",", 
        RowBox[{"subdir", "<>", "\"\<D1_Neg\>\""}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"testIntegrator", "[", 
       RowBox[{"meta", ",", "tId", ",", "inOp", ",", "intgD1P", ",", 
        RowBox[{"subdir", "<>", "\"\<D1_P\>\""}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"testIntegrator", "[", 
       RowBox[{"meta", ",", "tId", ",", "inOp", ",", "fftD2", ",", 
        RowBox[{"subdir", "<>", "\"\<D2\>\""}]}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8480417499460173`*^9, 3.848041751710577*^9}, {
   3.848041917107429*^9, 3.848042069705041*^9}, {3.848042104298834*^9, 
   3.8480421047567987`*^9}, {3.8480519574942636`*^9, 3.848052001991641*^9}, {
   3.8484765440263453`*^9, 3.8484765633816566`*^9}, {3.848476611045773*^9, 
   3.8484766837044353`*^9}, {3.84847672349049*^9, 3.848476882622653*^9}, {
   3.848476985943591*^9, 3.848476988641829*^9}, {3.848477122141608*^9, 
   3.848477146295006*^9}, {3.84847753185931*^9, 3.8484775362079144`*^9}, {
   3.848477961302064*^9, 3.8484779657515182`*^9}, 3.848478012527858*^9, {
   3.8485441404093246`*^9, 3.848544183371348*^9}, {3.84854439308457*^9, 
   3.848544393404928*^9}, {3.8485516721532793`*^9, 3.848551686143037*^9}, {
   3.848551969847752*^9, 3.848551983965369*^9}, {3.848553083830455*^9, 
   3.8485530849589977`*^9}, {3.848553201670513*^9, 3.84855332628727*^9}, {
   3.848553504463655*^9, 3.8485535276448307`*^9}, {3.848553574423992*^9, 
   3.84855357698308*^9}, 3.8485548255156*^9, 3.848712349965025*^9, 
   3.848712501857559*^9, {3.848712537951961*^9, 3.848712543773827*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"717f521a-42ac-47a5-9dfc-24606c84bdb7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"generateIntegrators", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"10", ",", 
      RowBox[{"dealiasMixed", "[", "10", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}], ",", "0", ",", 
    "minSpectrum"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.848477163759015*^9, 3.848477163938704*^9}, {
  3.848544186916778*^9, 3.848544187240117*^9}, {3.848546886656233*^9, 
  3.8485468872569017`*^9}, {3.848553102966199*^9, 3.848553105202207*^9}, {
  3.8568845569016657`*^9, 3.8568845611295033`*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"3b25c195-9571-4d45-8884-cf32b779f693"],

Cell[BoxData[
 RowBox[{
  RowBox[{"generateIntegrators", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"10", ",", 
      RowBox[{"dealiasMixed", "[", "10", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}], ",", "1", ",", 
    "maxSpectrum"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.848477604857543*^9, 3.848477613519485*^9}, {
   3.848544188566922*^9, 3.8485441888901176`*^9}, {3.8485468916319857`*^9, 
   3.848546892273322*^9}, {3.848553107980978*^9, 3.848553109712812*^9}, 
   3.856884564070385*^9},
 CellLabel->
  "In[102]:=",ExpressionUUID->"e4ef98e0-4d1f-40f2-9055-936acfdc1d37"],

Cell[BoxData[
 RowBox[{
  RowBox[{"generateIntegrators", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"10", ",", 
      RowBox[{"dealiasMixed", "[", "10", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}], ",", "2", ",", 
    "unitSpectrum"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.848477608787516*^9, 3.84847761962344*^9}, {
   3.8485441933401527`*^9, 3.8485441938038883`*^9}, {3.848546895036005*^9, 
   3.8485468954955597`*^9}, {3.8485520076838837`*^9, 
   3.8485520088603153`*^9}, {3.848553113722967*^9, 3.8485531157363997`*^9}, 
   3.856884564962647*^9, {3.885275493681765*^9, 3.8852755587529783`*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"3b2b5180-08b3-4923-b970-1773f9f43ce4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"generateIntegrators", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"25", ",", 
      RowBox[{"dealiasMixed", "[", "25", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}], ",", "3", ",", 
    "unitSpectrum"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.895190138801817*^9, 3.895190153551553*^9}, {
  3.895190245766117*^9, 3.8951902480487413`*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"9c2fa73e-f123-4ea8-a864-c9b64be965aa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"generateIntegrators", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"85", ",", 
      RowBox[{"dealiasMixed", "[", "85", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}], ",", "4", ",", 
    "unitSpectrum"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.895190145571412*^9, 3.8951901552219343`*^9}},
 CellLabel->
  "In[105]:=",ExpressionUUID->"8a344678-66aa-4e48-9a47-86a1b57f318f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Simulate", " ", "optimized", " ", "grid", " ", "size", " ", "by", " ", 
    "1"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"generateIntegrators", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"10", ",", 
       RowBox[{
        RowBox[{"dealiasMixed", "[", "10", "]"}], "+", "1"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}], ",", "5", ",", 
     "unitSpectrum"}], "]"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.896346906152481*^9, 3.896346962368355*^9}, {
  3.896347289847547*^9, 
  3.896347294552516*^9}},ExpressionUUID->"005b04ef-a24c-4031-89ff-\
673ef7cbfbf5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Simulate", " ", "optimized", " ", "grid", " ", "size", " ", "by", " ", 
    "2"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"generateIntegrators", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"10", ",", 
       RowBox[{
        RowBox[{"dealiasMixed", "[", "10", "]"}], "+", "2"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}], ",", "6", ",", 
     "unitSpectrum"}], "]"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.896346906152481*^9, 3.896346924532403*^9}, {
  3.896346965442862*^9, 3.896346967126709*^9}, {3.896347296688796*^9, 
  3.8963473016489143`*^9}},ExpressionUUID->"24d1e3d7-10d5-4b15-b482-\
96ac1e45a4a1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"For", "[", " ", 
   RowBox[{
    RowBox[{"p", " ", "=", " ", "7"}], ",", 
    RowBox[{"p", "<", "10"}], ",", 
    RowBox[{"p", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nM", "=", 
      SuperscriptBox["2", "p"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nG", " ", "=", 
      RowBox[{"dealiasMixed", "[", "nM", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"meta", "=", 
      RowBox[{"{", 
       RowBox[{"nM", ",", "nG", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"m", ",", 
          RowBox[{"{", 
           RowBox[{"m", ",", "0", ",", 
            RowBox[{"nM", "-", "1"}]}], "}"}]}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"generateIntegrators", "[", 
      RowBox[{"meta", ",", 
       RowBox[{"100", "+", "p"}], ",", "unitSpectrum"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Clear", "[", "nM", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Clear", "[", "nG", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Clear", "[", "meta", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "p", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.848477608787516*^9, 3.84847761962344*^9}, {
   3.8485441933401527`*^9, 3.8485441938038883`*^9}, {3.848546895036005*^9, 
   3.8485468954955597`*^9}, {3.8485520076838837`*^9, 
   3.8485520088603153`*^9}, {3.848553113722967*^9, 3.8485531157363997`*^9}, 
   3.856884564962647*^9, {3.885275493681765*^9, 3.885275584985551*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"3ac37ce4-f146-4b94-9c79-feb4d48086db"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"testBFLoop", "[", 
    RowBox[{
    "meta_", ",", "id_", ",", "infunc_", ",", "bopfunc_", ",", "fopfunc_", 
     ",", "name_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"outprec", " ", "=", " ", "32"}], ",", "i", ",", "nN", ",", 
       "maxN", ",", "gridN", ",", "ks", ",", "descr", ",", " ", "spec", ",", 
       "specFft", ",", "grid", ",", "phys", ",", "inData", ",", "refData", 
       ",", "msg", ",", "tempmsg", ",", "fbase", ",", "fname"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nN", "=", 
       RowBox[{"meta", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"maxN", "=", 
       RowBox[{"nN", "-", "1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gridN", " ", "=", " ", 
       RowBox[{"meta", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ks", "=", 
       RowBox[{"meta", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"spec", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"N", "[", 
          RowBox[{
           RowBox[{"infunc", "[", 
            RowBox[{
             RowBox[{"i", "-", "1"}], ",", "maxN", ",", 
             RowBox[{"ks", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", "mpprec"}], "]"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nN"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "@", "ks"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"inData", " ", "=", " ", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Re", "[", "spec", "]"}], ",", 
         RowBox[{"Im", "[", "spec", "]"}]}], "]"}]}], ";", 
      RowBox[{"msg", "=", 
       RowBox[{
       "\"\<Exporting \>\"", "<>", "name", "<>", 
        "\"\< Fourier operator for N = \>\"", "<>", 
        RowBox[{"ToString", "[", "maxN", "]"}], "<>", "\"\<, Ng = \>\"", " ", 
        "<>", 
        RowBox[{"ToString", "[", "gridN", "]"}], "<>", "\"\<, m = \>\"", "<>", 
        RowBox[{"ToString", "[", "ks", "]"}], "<>", "\"\<...\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"spec", "=", 
       RowBox[{"bopfunc", "[", "spec", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"specFft", "=", 
       RowBox[{"PadRight", "[", 
        RowBox[{"spec", ",", 
         RowBox[{"{", 
          RowBox[{"gridN", ",", 
           RowBox[{"Length", "@", "ks"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"specFft", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"nN", "-", "1"}], ")"}]}], ";;"}], ",", ";;"}], "]"}], 
        "]"}], " ", "=", " ", 
       RowBox[{"Reverse", "[", 
        RowBox[{"Conjugate", "[", 
         RowBox[{"specFft", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"2", ";;", "nN"}], ",", ";;"}], "]"}], "]"}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"phys", "=", 
       RowBox[{"ParallelTable", "[", 
        RowBox[{
         RowBox[{"Re", "[", 
          RowBox[{"InverseFourier", "[", 
           RowBox[{
            RowBox[{"specFft", "[", 
             RowBox[{"[", 
              RowBox[{";;", ",", "j"}], "]"}], "]"}], ",", 
            RowBox[{"FourierParameters", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", 
               RowBox[{"-", "1"}]}], "}"}]}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "@", "ks"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"specFft", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"ParallelTable", "[", 
         RowBox[{
          RowBox[{"Fourier", "[", 
           RowBox[{
            RowBox[{"phys", "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", ";;"}], "]"}], "]"}], ",", 
            RowBox[{"FourierParameters", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", 
               RowBox[{"-", "1"}]}], "}"}]}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"Length", "@", "ks"}]}], "}"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"spec", "=", 
       RowBox[{"specFft", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"1", ";;", "nN"}], ",", ";;"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"refData", " ", "=", 
       RowBox[{"N", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Re", "[", "spec", "]"}], ",", 
           RowBox[{"Im", "[", "spec", "]"}]}], "]"}], ",", "outprec"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"fbase", "=", 
       RowBox[{"name", "<>", "\"\<_id\>\"", "<>", 
        RowBox[{"ToString", "[", "id", "]"}]}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"fname", "=", 
       RowBox[{"fbase", "<>", "\"\<_meta.dat\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"descr", "=", 
       RowBox[{"Flatten", "[", "meta", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"descr", " ", "=", " ", 
       RowBox[{"Prepend", "[", 
        RowBox[{"descr", ",", 
         RowBox[{"Length", "@", "descr"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{"dataroot", ",", "refdir", ",", "fname"}], "}"}], "]"}], 
         "]"}], ",", "descr"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"fname", "=", 
       RowBox[{"fbase", "<>", "\"\<_in.dat\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{"dataroot", ",", "refdir", ",", "fname"}], "}"}], "]"}], 
         "]"}], ",", "inData", ",", "\"\<Table\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fname", "=", 
       RowBox[{"fbase", "<>", "\"\<_ref.dat\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{"dataroot", ",", "refdir", ",", "fname"}], "}"}], "]"}], 
         "]"}], ",", "refData", ",", "\"\<Table\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"Row", "[", 
        RowBox[{"{", 
         RowBox[{"msg", ",", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"\"\< Done(\>\"", "<>", 
             RowBox[{"DateString", "[", "]"}], "<>", "\"\<)\>\""}], ",", 
            RowBox[{"FontColor", "\[Rule]", "Green"}]}], "]"}]}], "}"}], 
        "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.848544082531231*^9, 3.8485441206159887`*^9}, {
   3.848544199470216*^9, 3.848544202531197*^9}, {3.8485442419673758`*^9, 
   3.8485442841474247`*^9}, {3.8485443158079443`*^9, 3.848544379452045*^9}, {
   3.848544491944911*^9, 3.848544503082264*^9}, {3.84854690348077*^9, 
   3.848546946436736*^9}, {3.848548282022455*^9, 3.8485482826431026`*^9}, {
   3.8485488440489492`*^9, 3.848548845407783*^9}, {3.848548923972725*^9, 
   3.848548926086543*^9}, 3.848549004725293*^9, {3.848549042151484*^9, 
   3.848549060158608*^9}, {3.8485492080664463`*^9, 3.848549218216367*^9}, {
   3.848549336659297*^9, 3.84854934256061*^9}, 3.8485494057905493`*^9, {
   3.848549495000537*^9, 3.848549507847514*^9}, {3.8485497230519943`*^9, 
   3.848549760434679*^9}, {3.848549794194234*^9, 3.848549881917148*^9}, {
   3.848549933607978*^9, 3.8485499337645597`*^9}, {3.84855004852782*^9, 
   3.848550085828267*^9}, {3.8485502386027718`*^9, 3.848550263153633*^9}, {
   3.848550299617405*^9, 3.848550326746565*^9}, {3.848550388207848*^9, 
   3.848550395894126*^9}, {3.848550438001481*^9, 3.848550452380403*^9}, {
   3.848550484309864*^9, 3.848550492040352*^9}, {3.84855053626206*^9, 
   3.84855053777932*^9}, {3.848550637170566*^9, 3.84855065640476*^9}, 
   3.848550731974621*^9, {3.84855108595995*^9, 3.8485510862573357`*^9}, {
   3.848551348739162*^9, 3.8485513720404863`*^9}, {3.848551704484617*^9, 
   3.848551707018684*^9}, {3.8485517815033083`*^9, 3.848551797939369*^9}, {
   3.848552167777462*^9, 3.848552168616691*^9}, {3.848711183791305*^9, 
   3.848711263046679*^9}, {3.84871131754592*^9, 3.848711433844955*^9}, {
   3.848712693534672*^9, 3.8487127030995626`*^9}, {3.8487127651790857`*^9, 
   3.84871281372108*^9}, {3.848712923355554*^9, 3.848713033451232*^9}, {
   3.8487130734152*^9, 3.84871307723792*^9}, {3.848713130436252*^9, 
   3.848713161430956*^9}, {3.848713206868866*^9, 3.8487132954526463`*^9}, {
   3.848713328528398*^9, 3.848713387120001*^9}, {3.848713424040687*^9, 
   3.848713494893417*^9}, {3.848713532865403*^9, 3.848713648055636*^9}, {
   3.8510438460900993`*^9, 3.851043857694106*^9}, {3.85693260996797*^9, 
   3.856932613634989*^9}, 3.856932646456266*^9, {3.856932784892062*^9, 
   3.856932814972278*^9}, 3.856932969912348*^9},
 CellLabel->"In[24]:=",ExpressionUUID->"e35e6a37-fe57-47d5-b8ae-30182b05b3ec"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"generateBFLoops", "[", 
    RowBox[{"meta_", ",", "tId_", ",", "inOp_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "subdir", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"subdir", " ", "=", " ", "\"\<BFLoop/\>\""}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"testBFLoop", "[", 
       RowBox[{"meta", ",", "tId", ",", "inOp", ",", "fftP", ",", "fftP", ",", 
        RowBox[{"subdir", "<>", "\"\<P\>\""}]}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8480417499460173`*^9, 3.848041751710577*^9}, {
   3.848041917107429*^9, 3.848042069705041*^9}, {3.848042104298834*^9, 
   3.8480421047567987`*^9}, {3.8480519574942636`*^9, 3.848052001991641*^9}, {
   3.8484765440263453`*^9, 3.8484765633816566`*^9}, {3.848476611045773*^9, 
   3.8484766837044353`*^9}, {3.84847672349049*^9, 3.848476882622653*^9}, {
   3.848476985943591*^9, 3.848476988641829*^9}, {3.848477122141608*^9, 
   3.848477146295006*^9}, {3.84847753185931*^9, 3.8484775362079144`*^9}, {
   3.848477961302064*^9, 3.8484779657515182`*^9}, 3.848478012527858*^9, {
   3.8485441404093246`*^9, 3.848544183371348*^9}, {3.84854439308457*^9, 
   3.848544393404928*^9}, {3.8485516721532793`*^9, 3.848551686143037*^9}, {
   3.848551969847752*^9, 3.848551983965369*^9}, {3.848553083830455*^9, 
   3.8485530849589977`*^9}, {3.848553201670513*^9, 3.84855332628727*^9}, {
   3.848553504463655*^9, 3.8485535276448307`*^9}, {3.848553574423992*^9, 
   3.84855357698308*^9}, 3.8485548255156*^9, 3.848712349965025*^9, 
   3.848712501857559*^9, {3.848712537951961*^9, 3.848712543773827*^9}, {
   3.848712605450184*^9, 3.8487126257097063`*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"cba94c21-cf3e-4d7b-98e3-bdf08e182a90"],

Cell[BoxData[
 RowBox[{
  RowBox[{"generateBFLoops", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"10", ",", 
      RowBox[{"dealiasMixed", "[", "10", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}], ",", "0", ",", 
    "minSpectrum"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.848477163759015*^9, 3.848477163938704*^9}, {
  3.848544186916778*^9, 3.848544187240117*^9}, {3.848546886656233*^9, 
  3.8485468872569017`*^9}, {3.848553102966199*^9, 3.848553105202207*^9}, {
  3.848712635922364*^9, 3.848712636928759*^9}, {3.8487136515375023`*^9, 
  3.848713652377409*^9}, {3.856932622633642*^9, 3.8569326318810673`*^9}},
 CellLabel->
  "In[110]:=",ExpressionUUID->"ec953571-7010-4c5f-aaa4-10e822d34123"],

Cell[BoxData[
 RowBox[{
  RowBox[{"generateBFLoops", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"10", ",", 
      RowBox[{"dealiasMixed", "[", "10", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}], ",", "1", ",", 
    "maxSpectrum"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.848477604857543*^9, 3.848477613519485*^9}, {
  3.848544188566922*^9, 3.8485441888901176`*^9}, {3.8485468916319857`*^9, 
  3.848546892273322*^9}, {3.848553107980978*^9, 3.848553109712812*^9}, {
  3.848712640032075*^9, 3.8487126418827*^9}, {3.856932635586081*^9, 
  3.856932661399026*^9}},
 CellLabel->
  "In[111]:=",ExpressionUUID->"9c76cf2b-fc7b-46fe-ab59-fb02e7a95720"],

Cell[BoxData[
 RowBox[{
  RowBox[{"generateBFLoops", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"10", ",", 
      RowBox[{"dealiasMixed", "[", "10", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}], ",", "2", ",", 
    "unitSpectrum"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.848477608787516*^9, 3.84847761962344*^9}, {
   3.8485441933401527`*^9, 3.8485441938038883`*^9}, {3.848546895036005*^9, 
   3.8485468954955597`*^9}, {3.8485520076838837`*^9, 
   3.8485520088603153`*^9}, {3.848553113722967*^9, 3.8485531157363997`*^9}, {
   3.848712646415463*^9, 3.848712647382514*^9}, 3.8569326362964687`*^9},
 CellLabel->
  "In[112]:=",ExpressionUUID->"39339114-9d60-4a4a-a453-770f21a81bfb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"generateBFLoops", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"25", ",", 
      RowBox[{"dealiasMixed", "[", "25", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}], ",", "3", ",", 
    "unitSpectrum"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.895190210845333*^9, 3.8951902243818398`*^9}, {
  3.895190645685717*^9, 3.895190646052485*^9}},
 CellLabel->
  "In[115]:=",ExpressionUUID->"63c692b6-56c0-4109-95e9-b2ec7df60e9d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"generateBFLoops", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"85", ",", 
      RowBox[{"dealiasMixed", "[", "85", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}], ",", "4", ",", 
    "unitSpectrum"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.895190219712269*^9, 3.8951902272424917`*^9}, {
  3.8951906474211283`*^9, 3.895190647893368*^9}},
 CellLabel->
  "In[116]:=",ExpressionUUID->"a2042a48-a3d6-41ca-b575-de254badc1fa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Simulate", " ", "optimized", " ", "grid", " ", "size", " ", "by", " ", 
    "1"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"generateBFLoops", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"10", ",", 
       RowBox[{
        RowBox[{"dealiasMixed", "[", "10", "]"}], "+", "1"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}], ",", "5", ",", 
     "minSpectrum"}], "]"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.848477163759015*^9, 3.848477163938704*^9}, {
  3.848544186916778*^9, 3.848544187240117*^9}, {3.848546886656233*^9, 
  3.8485468872569017`*^9}, {3.848553102966199*^9, 3.848553105202207*^9}, {
  3.848712635922364*^9, 3.848712636928759*^9}, {3.8487136515375023`*^9, 
  3.848713652377409*^9}, {3.856932622633642*^9, 3.8569326318810673`*^9}, {
  3.8963470610669813`*^9, 3.8963470702465887`*^9}, {3.896347309026853*^9, 
  3.896347313628652*^9}},ExpressionUUID->"575eb797-230f-45fb-9377-\
884a50ad2c73"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Simulate", " ", "optimized", " ", "grid", " ", "size", " ", "by", " ", 
    "2"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"generateBFLoops", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"10", ",", 
       RowBox[{
        RowBox[{"dealiasMixed", "[", "10", "]"}], "+", "2"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}], ",", "6", ",", 
     "minSpectrum"}], "]"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.848477163759015*^9, 3.848477163938704*^9}, {
  3.848544186916778*^9, 3.848544187240117*^9}, {3.848546886656233*^9, 
  3.8485468872569017`*^9}, {3.848553102966199*^9, 3.848553105202207*^9}, {
  3.848712635922364*^9, 3.848712636928759*^9}, {3.8487136515375023`*^9, 
  3.848713652377409*^9}, {3.856932622633642*^9, 3.8569326318810673`*^9}, {
  3.896347065690937*^9, 3.8963470722844*^9}, {3.896347310874852*^9, 
  3.896347311452311*^9}},ExpressionUUID->"d5202200-a883-4489-9581-\
e40ca448fc27"]
},
WindowSize->{768., 379.5},
WindowMargins->{{-2646, Automatic}, {Automatic, 81.75}},
FrontEndVersion->"12.3 for Linux x86 (64-bit) (June 30, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"970b2a3b-777e-489f-9ee9-5610a1b705a0"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 9875, 280, 582, "Input",ExpressionUUID->"5cfe7242-35d0-4108-bf14-5f6315b84ca8"],
Cell[10436, 302, 8076, 185, 608, "Input",ExpressionUUID->"9a715d2e-661b-4abf-a363-ca916e311d73"],
Cell[18515, 489, 2333, 43, 174, "Input",ExpressionUUID->"a56f9f9c-0f76-4cd2-b0f4-f3d48a7183f1"],
Cell[20851, 534, 701, 15, 29, "Input",ExpressionUUID->"2ab4f447-f7f2-40e6-b941-4202f5e4e819"],
Cell[21555, 551, 580, 13, 29, "Input",ExpressionUUID->"9740f07b-a703-4899-9202-375f720751c9"],
Cell[22138, 566, 784, 16, 29, "Input",ExpressionUUID->"125bbac1-ae90-43c8-b15d-e47c5f5c0406"],
Cell[22925, 584, 863, 18, 29, "Input",ExpressionUUID->"4075eb96-b413-4398-bf2f-e1d56fba6bc5"],
Cell[23791, 604, 810, 16, 29, "Input",ExpressionUUID->"56ddd12e-658e-4d4f-915a-75beb73a0d53"],
Cell[24604, 622, 1490, 36, 219, "Input",ExpressionUUID->"89b2fa86-7552-4152-94cd-a9bd7ecaa4f9"],
Cell[26097, 660, 7461, 178, 628, "Input",ExpressionUUID->"3431dbbf-d06e-40e6-82e0-698201dea67c"],
Cell[33561, 840, 2569, 46, 174, "Input",ExpressionUUID->"717f521a-42ac-47a5-9dfc-24606c84bdb7"],
Cell[36133, 888, 658, 15, 29, "Input",ExpressionUUID->"3b25c195-9571-4d45-8884-cf32b779f693"],
Cell[36794, 905, 635, 15, 29, "Input",ExpressionUUID->"e4ef98e0-4d1f-40f2-9055-936acfdc1d37"],
Cell[37432, 922, 741, 16, 29, "Input",ExpressionUUID->"3b2b5180-08b3-4923-b970-1773f9f43ce4"],
Cell[38176, 940, 511, 13, 29, "Input",ExpressionUUID->"9c2fa73e-f123-4ea8-a864-c9b64be965aa"],
Cell[38690, 955, 462, 12, 29, "Input",ExpressionUUID->"8a344678-66aa-4e48-9a47-86a1b57f318f"],
Cell[39155, 969, 684, 19, 51, "Input",ExpressionUUID->"005b04ef-a24c-4031-89ff-673ef7cbfbf5"],
Cell[39842, 990, 732, 19, 51, "Input",ExpressionUUID->"24d1e3d7-10d5-4b15-b482-96ac1e45a4a1"],
Cell[40577, 1011, 1636, 37, 219, "Input",ExpressionUUID->"3ac37ce4-f146-4b94-9c79-feb4d48086db"],
Cell[42216, 1050, 9584, 219, 669, "Input",ExpressionUUID->"e35e6a37-fe57-47d5-b8ae-30182b05b3ec"],
Cell[51803, 1271, 1813, 31, 92, "Input",ExpressionUUID->"cba94c21-cf3e-4d7b-98e3-bdf08e182a90"],
Cell[53619, 1304, 749, 16, 29, "Input",ExpressionUUID->"ec953571-7010-4c5f-aaa4-10e822d34123"],
Cell[54371, 1322, 699, 16, 29, "Input",ExpressionUUID->"9c76cf2b-fc7b-46fe-ab59-fb02e7a95720"],
Cell[55073, 1340, 737, 16, 29, "Input",ExpressionUUID->"39339114-9d60-4a4a-a453-770f21a81bfb"],
Cell[55813, 1358, 507, 13, 29, "Input",ExpressionUUID->"63c692b6-56c0-4109-95e9-b2ec7df60e9d"],
Cell[56323, 1373, 509, 13, 29, "Input",ExpressionUUID->"a2042a48-a3d6-41ca-b575-de254badc1fa"],
Cell[56835, 1388, 1023, 23, 51, "Input",ExpressionUUID->"575eb797-230f-45fb-9377-884a50ad2c73"],
Cell[57861, 1413, 1017, 23, 51, "Input",ExpressionUUID->"d5202200-a883-4489-9581-e40ca448fc27"]
}
]
*)

