(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     67812,       1709]
NotebookOptionsPosition[     66909,       1689]
NotebookOutlinePosition[     67364,       1706]
CellTagsIndexPosition[     67321,       1703]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
  "quiccroot", "=", 
   "\"\</home/phmarti/Documents/QuICC/build/QuICC_devel/serial\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$MaxExtraPrecision", "=", "1000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mpprec", "=", "500"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"w\[Alpha]", "=", "0"}], ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"chebgrid", "[", "n_", "]"}], ":=", 
  RowBox[{"N", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"2", "k"}], "-", "1"}], 
         RowBox[{"2", "n"}]], "\[Pi]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", "mpprec"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"chebweights", "[", "n_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     FractionBox["1", "n"], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dctnorm", "[", 
    RowBox[{"n_", ",", "a_", ",", "b_"}], "]"}], "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"n", "==", "0"}], ",", "1", ",", "2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dChebyshev", "[", 
    RowBox[{"n_", ",", "a_", ",", "b_", ",", "t_"}], "]"}], "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     FractionBox["1", "a"], 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"ChebyshevT", "[", 
        RowBox[{"n", ",", "t"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "1"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"dyChebyshev", "[", 
     RowBox[{"n_", ",", "a_", ",", "b_", ",", "t_"}], "]"}], "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"ChebyshevT", "[", 
       RowBox[{"n", ",", "t"}], "]"}], "+", 
      RowBox[{
       FractionBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", " ", "t"}], " ", "+", " ", "b"}], ")"}], "a"], 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"ChebyshevT", "[", 
          RowBox[{"n", ",", "t"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "1"}], "}"}]}], "]"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Operators", " ", "to", " ", "work", " ", "on", " ", "grid"}], " ",
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tnab", "[", 
    RowBox[{"n_", ",", "a_", ",", "b_", ",", "x_"}], "]"}], ":=", 
   RowBox[{"ChebyshevT", "[", 
    RowBox[{"n", ",", "x"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dTnab", "[", 
    RowBox[{"n_", ",", "a_", ",", "b_", ",", "x_"}], "]"}], ":=", 
   RowBox[{"dChebyshev", "[", 
    RowBox[{"n", ",", "a", ",", "b", ",", "x"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"yTnab", "[", 
    RowBox[{"n_", ",", "a_", ",", "b_", ",", "x_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", " ", "x"}], " ", "+", " ", "b"}], ")"}], 
    RowBox[{"ChebyshevT", "[", 
     RowBox[{"n", ",", "x"}], "]"}]}]}], ";", 
  RowBox[{
   RowBox[{"y2Tnab", "[", 
    RowBox[{"n_", ",", "a_", ",", "b_", ",", "x_"}], "]"}], ":=", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", " ", "x"}], " ", "+", " ", "b"}], ")"}], "2"], 
    RowBox[{"ChebyshevT", "[", 
     RowBox[{"n", ",", "x"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y3Tnab", "[", 
    RowBox[{"n_", ",", "a_", ",", "b_", ",", "x_"}], "]"}], ":=", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", " ", "x"}], " ", "+", " ", "b"}], ")"}], "3"], 
    RowBox[{"ChebyshevT", "[", 
     RowBox[{"n", ",", "x"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ydyTnab", "[", 
    RowBox[{"n_", ",", "a_", ",", "b_", ",", "x_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", " ", "x"}], " ", "+", " ", "b"}], ")"}], 
    RowBox[{"dyChebyshev", "[", 
     RowBox[{"n", ",", "a", ",", "b", ",", "x"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"y3dyTnab", "[", 
     RowBox[{"n_", ",", "a_", ",", "b_", ",", "x_"}], "]"}], ":=", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", " ", "x"}], " ", "+", " ", "b"}], ")"}], "3"], 
     RowBox[{"dyChebyshev", "[", 
      RowBox[{"n", ",", "a", ",", "b", ",", "x"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Integration", " ", "opeators"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y1", "[", 
    RowBox[{
    "row_", ",", "nN_", ",", "a_", ",", "b_", ",", "gfunc_", ",", " ", 
     "wfunc_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"grid", ",", "wgts", ",", "s", ",", "gN", ",", "p"}], "}"}], 
     ",", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gN", "=", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"Ceiling", "[", 
          RowBox[{"3", 
           RowBox[{"nN", "/", "2"}]}], "]"}], ",", "10"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"grid", "=", 
       RowBox[{"gfunc", "[", "gN", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"wgts", "=", 
       RowBox[{"wfunc", "[", "gN", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"s", "=", " ", 
       RowBox[{
        RowBox[{"dctnorm", "[", 
         RowBox[{"row", ",", "a", ",", "b"}], "]"}], 
        RowBox[{"yTnab", "[", 
         RowBox[{"row", ",", "a", ",", "b", ",", " ", "x"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"p", "=", 
       RowBox[{"s", "/.", 
        RowBox[{"{", 
         RowBox[{"x", "->", "grid"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"VectorQ", "[", "p", "]"}]}], ",", 
        RowBox[{"p", "=", 
         RowBox[{"0", " ", "grid"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"s", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nN"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"s", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;"}], "]"}], "]"}], "=", 
       RowBox[{"ParallelTable", "[", 
        RowBox[{
         RowBox[{"Dot", "[", 
          RowBox[{
           RowBox[{"wgts", " ", 
            RowBox[{"Tnab", "[", 
             RowBox[{"i", ",", "a", ",", "b", ",", "grid"}], "]"}]}], ",", 
           "p"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{"nN", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "s"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y2", "[", 
    RowBox[{
    "row_", ",", "nN_", ",", "a_", ",", "b_", ",", "gfunc_", ",", " ", 
     "wfunc_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"grid", ",", "wgts", ",", "s", ",", "gN", ",", "p"}], "}"}], 
     ",", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gN", "=", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"Ceiling", "[", 
          RowBox[{"3", 
           RowBox[{"nN", "/", "2"}]}], "]"}], ",", "10"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"grid", "=", 
       RowBox[{"gfunc", "[", "gN", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"wgts", "=", 
       RowBox[{"wfunc", "[", "gN", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"s", "=", " ", 
       RowBox[{
        RowBox[{"dctnorm", "[", 
         RowBox[{"row", ",", "a", ",", "b"}], "]"}], 
        RowBox[{"y2Tnab", "[", 
         RowBox[{"row", ",", "a", ",", "b", ",", " ", "x"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"p", "=", 
       RowBox[{"s", "/.", 
        RowBox[{"{", 
         RowBox[{"x", "->", "grid"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"VectorQ", "[", "p", "]"}]}], ",", 
        RowBox[{"p", "=", 
         RowBox[{"0", " ", "grid"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"s", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nN"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"s", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;"}], "]"}], "]"}], "=", 
       RowBox[{"ParallelTable", "[", 
        RowBox[{
         RowBox[{"Dot", "[", 
          RowBox[{
           RowBox[{"wgts", " ", 
            RowBox[{"Tnab", "[", 
             RowBox[{"i", ",", "a", ",", "b", ",", "grid"}], "]"}]}], ",", 
           "p"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{"nN", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "s"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"i1", "[", 
    RowBox[{
    "row_", ",", "nN_", ",", "a_", ",", "b_", ",", "gfunc_", ",", " ", 
     "wfunc_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"grid", ",", "wgts", ",", "s", ",", "gN", ",", "p"}], "}"}], 
     ",", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gN", "=", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"Ceiling", "[", 
          RowBox[{"3", 
           RowBox[{"nN", "/", "2"}]}], "]"}], ",", "10"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"grid", "=", 
       RowBox[{"gfunc", "[", "gN", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"wgts", "=", 
       RowBox[{"wfunc", "[", "gN", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"s", "=", " ", 
       RowBox[{
        RowBox[{"dctnorm", "[", 
         RowBox[{"row", ",", "a", ",", "b"}], "]"}], "a", " ", 
        RowBox[{"Integrate", "[", 
         RowBox[{
          RowBox[{"Tnab", "[", 
           RowBox[{"row", ",", "a", ",", "b", ",", " ", "x"}], "]"}], ",", 
          "x"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"p", "=", 
       RowBox[{"s", "/.", 
        RowBox[{"{", 
         RowBox[{"x", "->", "grid"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"VectorQ", "[", "p", "]"}]}], ",", 
        RowBox[{"p", "=", 
         RowBox[{"0", " ", "grid"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"s", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nN"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"s", "[", 
        RowBox[{"[", 
         RowBox[{"2", ";;"}], "]"}], "]"}], "=", 
       RowBox[{"ParallelTable", "[", 
        RowBox[{
         RowBox[{"Dot", "[", 
          RowBox[{
           RowBox[{"wgts", " ", 
            RowBox[{"Tnab", "[", 
             RowBox[{"i", ",", "a", ",", "b", ",", "grid"}], "]"}]}], ",", 
           "p"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"nN", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "s"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"i2", "[", 
    RowBox[{
    "row_", ",", "nN_", ",", "a_", ",", "b_", ",", "gfunc_", ",", " ", 
     "wfunc_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"grid", ",", "wgts", ",", "s", ",", "gN", ",", "p"}], "}"}], 
     ",", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gN", "=", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"Ceiling", "[", 
          RowBox[{"3", 
           RowBox[{"nN", "/", "2"}]}], "]"}], ",", "10"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"grid", "=", 
       RowBox[{"gfunc", "[", "gN", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"wgts", "=", 
       RowBox[{"wfunc", "[", "gN", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"s", "=", 
       RowBox[{
        RowBox[{"dctnorm", "[", 
         RowBox[{"row", ",", "a", ",", "b"}], "]"}], " ", 
        SuperscriptBox["a", "2"], 
        RowBox[{"Integrate", "[", 
         RowBox[{
          RowBox[{"Tnab", "[", 
           RowBox[{"row", ",", "a", ",", "b", ",", " ", "x"}], "]"}], ",", 
          "x", ",", "x"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"p", "=", 
       RowBox[{"s", "/.", 
        RowBox[{"{", 
         RowBox[{"x", "->", "grid"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"VectorQ", "[", "p", "]"}]}], ",", 
        RowBox[{"p", "=", 
         RowBox[{"0", " ", "grid"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"s", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nN"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"s", "[", 
        RowBox[{"[", 
         RowBox[{"3", ";;"}], "]"}], "]"}], "=", 
       RowBox[{"ParallelTable", "[", 
        RowBox[{
         RowBox[{"Dot", "[", 
          RowBox[{
           RowBox[{"wgts", " ", 
            RowBox[{"Tnab", "[", 
             RowBox[{"i", ",", "a", ",", "b", ",", "grid"}], "]"}]}], ",", 
           "p"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"nN", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "s"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"i2y1", "[", 
    RowBox[{
    "row_", ",", "nN_", ",", "a_", ",", "b_", ",", "gfunc_", ",", " ", 
     "wfunc_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"grid", ",", "wgts", ",", "s", ",", "gN", ",", "p"}], "}"}], 
     ",", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gN", "=", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"Ceiling", "[", 
          RowBox[{"3", 
           RowBox[{"nN", "/", "2"}]}], "]"}], ",", "10"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"grid", "=", 
       RowBox[{"gfunc", "[", "gN", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"wgts", "=", 
       RowBox[{"wfunc", "[", "gN", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"s", "=", " ", 
       RowBox[{
        RowBox[{"dctnorm", "[", 
         RowBox[{"row", ",", "a", ",", "b"}], "]"}], 
        SuperscriptBox["a", "2"], 
        RowBox[{"Integrate", "[", 
         RowBox[{
          RowBox[{"yTnab", "[", 
           RowBox[{"row", ",", "a", ",", "b", ",", " ", "x"}], "]"}], ",", 
          "x", ",", "x"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"p", "=", 
       RowBox[{"s", "/.", 
        RowBox[{"{", 
         RowBox[{"x", "->", "grid"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"VectorQ", "[", "p", "]"}]}], ",", 
        RowBox[{"p", "=", 
         RowBox[{"0", " ", "grid"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"s", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nN"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"s", "[", 
        RowBox[{"[", 
         RowBox[{"3", ";;"}], "]"}], "]"}], "=", 
       RowBox[{"ParallelTable", "[", 
        RowBox[{
         RowBox[{"Dot", "[", 
          RowBox[{
           RowBox[{"wgts", " ", 
            RowBox[{"Tnab", "[", 
             RowBox[{"i", ",", "a", ",", "b", ",", "grid"}], "]"}]}], ",", 
           "p"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"nN", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "s"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"i2y2", "[", 
    RowBox[{
    "row_", ",", "nN_", ",", "a_", ",", "b_", ",", "gfunc_", ",", " ", 
     "wfunc_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"grid", ",", "wgts", ",", "s", ",", "gN", ",", "p"}], "}"}], 
     ",", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gN", "=", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"Ceiling", "[", 
          RowBox[{"3", 
           RowBox[{"nN", "/", "2"}]}], "]"}], ",", "10"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"grid", "=", 
       RowBox[{"gfunc", "[", "gN", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"wgts", "=", 
       RowBox[{"wfunc", "[", "gN", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"s", "=", " ", 
       RowBox[{
        RowBox[{"dctnorm", "[", 
         RowBox[{"row", ",", "a", ",", "b"}], "]"}], 
        SuperscriptBox["a", "2"], 
        RowBox[{"Integrate", "[", 
         RowBox[{
          RowBox[{"y2Tnab", "[", 
           RowBox[{"row", ",", "a", ",", "b", ",", " ", "x"}], "]"}], ",", 
          "x", ",", "x"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"p", "=", 
       RowBox[{"s", "/.", 
        RowBox[{"{", 
         RowBox[{"x", "->", "grid"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"VectorQ", "[", "p", "]"}]}], ",", 
        RowBox[{"p", "=", 
         RowBox[{"0", " ", "grid"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"s", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nN"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"s", "[", 
        RowBox[{"[", 
         RowBox[{"3", ";;"}], "]"}], "]"}], "=", 
       RowBox[{"ParallelTable", "[", 
        RowBox[{
         RowBox[{"Dot", "[", 
          RowBox[{
           RowBox[{"wgts", " ", 
            RowBox[{"Tnab", "[", 
             RowBox[{"i", ",", "a", ",", "b", ",", "grid"}], "]"}]}], ",", 
           "p"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"nN", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "s"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"i2d1", "[", 
    RowBox[{
    "row_", ",", "nN_", ",", "a_", ",", "b_", ",", "gfunc_", ",", " ", 
     "wfunc_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"grid", ",", "wgts", ",", "s", ",", "gN", ",", "p"}], "}"}], 
     ",", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gN", "=", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"Ceiling", "[", 
          RowBox[{"3", 
           RowBox[{"nN", "/", "2"}]}], "]"}], ",", "10"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"grid", "=", 
       RowBox[{"gfunc", "[", "gN", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"wgts", "=", 
       RowBox[{"wfunc", "[", "gN", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"s", "=", " ", 
       RowBox[{
        RowBox[{"dctnorm", "[", 
         RowBox[{"row", ",", "a", ",", "b"}], "]"}], 
        SuperscriptBox["a", "2"], 
        RowBox[{"Integrate", "[", 
         RowBox[{
          RowBox[{"dTnab", "[", 
           RowBox[{"row", ",", "a", ",", "b", ",", " ", "x"}], "]"}], ",", 
          "x", ",", "x"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"p", " ", "=", " ", 
       RowBox[{"s", "/.", 
        RowBox[{"{", 
         RowBox[{"x", "->", "grid"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"VectorQ", "[", "p", "]"}]}], ",", 
        RowBox[{"p", "=", 
         RowBox[{"0", " ", "grid"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"s", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nN"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"s", "[", 
        RowBox[{"[", 
         RowBox[{"3", ";;"}], "]"}], "]"}], "=", 
       RowBox[{"ParallelTable", "[", 
        RowBox[{
         RowBox[{"Dot", "[", 
          RowBox[{
           RowBox[{"wgts", " ", 
            RowBox[{"Tnab", "[", 
             RowBox[{"i", ",", "a", ",", "b", ",", "grid"}], "]"}]}], ",", 
           "p"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"nN", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "s"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"i2y1d1y1", "[", 
    RowBox[{
    "row_", ",", "nN_", ",", "a_", ",", "b_", ",", "gfunc_", ",", " ", 
     "wfunc_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"grid", ",", "wgts", ",", "s", ",", "gN", ",", "p"}], "}"}], 
     ",", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gN", "=", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"Ceiling", "[", 
          RowBox[{"3", 
           RowBox[{"nN", "/", "2"}]}], "]"}], ",", "10"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"grid", "=", 
       RowBox[{"gfunc", "[", "gN", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"wgts", "=", 
       RowBox[{"wfunc", "[", "gN", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"s", "=", " ", 
       RowBox[{
        RowBox[{"dctnorm", "[", 
         RowBox[{"row", ",", "a", ",", "b"}], "]"}], 
        SuperscriptBox["a", "2"], 
        RowBox[{"Integrate", "[", 
         RowBox[{
          RowBox[{"ydyTnab", "[", 
           RowBox[{"row", ",", "a", ",", "b", ",", " ", "x"}], "]"}], ",", 
          "x", ",", "x"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"p", " ", "=", " ", 
       RowBox[{"s", "/.", 
        RowBox[{"{", 
         RowBox[{"x", "->", "grid"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"VectorQ", "[", "p", "]"}]}], ",", 
        RowBox[{"p", "=", 
         RowBox[{"0", " ", "grid"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"s", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nN"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"s", "[", 
        RowBox[{"[", 
         RowBox[{"3", ";;"}], "]"}], "]"}], "=", 
       RowBox[{"ParallelTable", "[", 
        RowBox[{
         RowBox[{"Dot", "[", 
          RowBox[{
           RowBox[{"wgts", " ", 
            RowBox[{"Tnab", "[", 
             RowBox[{"i", ",", "a", ",", "b", ",", "grid"}], "]"}]}], ",", 
           "p"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"nN", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "s"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"i3", "[", 
    RowBox[{
    "row_", ",", "nN_", ",", "a_", ",", "b_", ",", "gfunc_", ",", " ", 
     "wfunc_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"grid", ",", "wgts", ",", "s", ",", "gN", ",", "p"}], "}"}], 
     ",", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gN", "=", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"Ceiling", "[", 
          RowBox[{"3", 
           RowBox[{"nN", "/", "2"}]}], "]"}], ",", "10"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"grid", "=", 
       RowBox[{"gfunc", "[", "gN", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"wgts", "=", 
       RowBox[{"wfunc", "[", "gN", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"s", "=", 
       RowBox[{
        RowBox[{"dctnorm", "[", 
         RowBox[{"row", ",", "a", ",", "b"}], "]"}], 
        SuperscriptBox["a", "3"], " ", 
        RowBox[{"Integrate", "[", 
         RowBox[{
          RowBox[{"Tnab", "[", 
           RowBox[{"row", ",", "a", ",", "b", ",", " ", "x"}], "]"}], ",", 
          "x", ",", "x", ",", "x"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"p", "=", 
       RowBox[{"s", "/.", 
        RowBox[{"{", 
         RowBox[{"x", "->", "grid"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"VectorQ", "[", "p", "]"}]}], ",", 
        RowBox[{"p", "=", 
         RowBox[{"0", " ", "grid"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"s", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nN"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"s", "[", 
        RowBox[{"[", 
         RowBox[{"4", ";;"}], "]"}], "]"}], "=", 
       RowBox[{"ParallelTable", "[", 
        RowBox[{
         RowBox[{"Dot", "[", 
          RowBox[{
           RowBox[{"wgts", " ", 
            RowBox[{"Tnab", "[", 
             RowBox[{"i", ",", "a", ",", "b", ",", "grid"}], "]"}]}], ",", 
           "p"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "3", ",", 
           RowBox[{"nN", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "s"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"i4", "[", 
    RowBox[{
    "row_", ",", "nN_", ",", "a_", ",", "b_", ",", "gfunc_", ",", " ", 
     "wfunc_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"grid", ",", "wgts", ",", "s", ",", "gN", ",", "p"}], "}"}], 
     ",", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gN", "=", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"Ceiling", "[", 
          RowBox[{"3", 
           RowBox[{"nN", "/", "2"}]}], "]"}], ",", "10"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"grid", "=", 
       RowBox[{"gfunc", "[", "gN", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"wgts", "=", 
       RowBox[{"wfunc", "[", "gN", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"s", "=", 
       RowBox[{
        RowBox[{"dctnorm", "[", 
         RowBox[{"row", ",", "a", ",", "b"}], "]"}], 
        SuperscriptBox["a", "4"], " ", 
        RowBox[{"Integrate", "[", 
         RowBox[{
          RowBox[{"Tnab", "[", 
           RowBox[{"row", ",", "a", ",", "b", ",", " ", "x"}], "]"}], ",", 
          "x", ",", "x", ",", "x", ",", "x"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"p", "=", 
       RowBox[{"s", "/.", 
        RowBox[{"{", 
         RowBox[{"x", "->", "grid"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"VectorQ", "[", "p", "]"}]}], ",", 
        RowBox[{"p", "=", 
         RowBox[{"0", " ", "grid"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"s", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nN"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"s", "[", 
        RowBox[{"[", 
         RowBox[{"5", ";;"}], "]"}], "]"}], "=", 
       RowBox[{"ParallelTable", "[", 
        RowBox[{
         RowBox[{"Dot", "[", 
          RowBox[{
           RowBox[{"wgts", " ", 
            RowBox[{"Tnab", "[", 
             RowBox[{"i", ",", "a", ",", "b", ",", "grid"}], "]"}]}], ",", 
           "p"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "4", ",", 
           RowBox[{"nN", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "s"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"i4y3", "[", 
    RowBox[{
    "row_", ",", "nN_", ",", "a_", ",", "b_", ",", "gfunc_", ",", " ", 
     "wfunc_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"grid", ",", "wgts", ",", "s", ",", "gN", ",", "p"}], "}"}], 
     ",", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gN", "=", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"Ceiling", "[", 
          RowBox[{"3", 
           RowBox[{"nN", "/", "2"}]}], "]"}], ",", "10"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"grid", "=", 
       RowBox[{"gfunc", "[", "gN", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"wgts", "=", 
       RowBox[{"wfunc", "[", "gN", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"s", "=", " ", 
       RowBox[{
        RowBox[{"dctnorm", "[", 
         RowBox[{"row", ",", "a", ",", "b"}], "]"}], 
        SuperscriptBox["a", "4"], 
        RowBox[{"Integrate", "[", 
         RowBox[{
          RowBox[{"y3Tnab", "[", 
           RowBox[{"row", ",", "a", ",", "b", ",", " ", "x"}], "]"}], ",", 
          "x", ",", "x", ",", "x", ",", "x"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"p", "=", 
       RowBox[{"s", "/.", 
        RowBox[{"{", 
         RowBox[{"x", "->", "grid"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"VectorQ", "[", "p", "]"}]}], ",", 
        RowBox[{"p", "=", 
         RowBox[{"0", " ", "grid"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"s", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nN"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"s", "[", 
        RowBox[{"[", 
         RowBox[{"5", ";;"}], "]"}], "]"}], "=", 
       RowBox[{"ParallelTable", "[", 
        RowBox[{
         RowBox[{"Dot", "[", 
          RowBox[{
           RowBox[{"wgts", " ", 
            RowBox[{"Tnab", "[", 
             RowBox[{"i", ",", "a", ",", "b", ",", "grid"}], "]"}]}], ",", 
           "p"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "4", ",", 
           RowBox[{"nN", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "s"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"i4d1", "[", 
    RowBox[{
    "row_", ",", "nN_", ",", "a_", ",", "b_", ",", "gfunc_", ",", " ", 
     "wfunc_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"grid", ",", "wgts", ",", "s", ",", "gN", ",", "p"}], "}"}], 
     ",", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gN", "=", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"Ceiling", "[", 
          RowBox[{"3", 
           RowBox[{"nN", "/", "2"}]}], "]"}], ",", "10"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"grid", "=", 
       RowBox[{"gfunc", "[", "gN", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"wgts", "=", 
       RowBox[{"wfunc", "[", "gN", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"s", "=", " ", 
       RowBox[{
        RowBox[{"dctnorm", "[", 
         RowBox[{"row", ",", "a", ",", "b"}], "]"}], 
        SuperscriptBox["a", "4"], 
        RowBox[{"Integrate", "[", 
         RowBox[{
          RowBox[{"dTnab", "[", 
           RowBox[{"row", ",", "a", ",", "b", ",", " ", "x"}], "]"}], ",", 
          "x", ",", "x", ",", "x", ",", "x"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"p", "=", 
       RowBox[{"s", "/.", 
        RowBox[{"{", 
         RowBox[{"x", "->", "grid"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"VectorQ", "[", "p", "]"}]}], ",", 
        RowBox[{"p", "=", 
         RowBox[{"0", " ", "grid"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"s", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nN"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"s", "[", 
        RowBox[{"[", 
         RowBox[{"5", ";;"}], "]"}], "]"}], "=", 
       RowBox[{"ParallelTable", "[", 
        RowBox[{
         RowBox[{"Dot", "[", 
          RowBox[{
           RowBox[{"wgts", " ", 
            RowBox[{"Tnab", "[", 
             RowBox[{"i", ",", "a", ",", "b", ",", "grid"}], "]"}]}], ",", 
           "p"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "4", ",", 
           RowBox[{"nN", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "s"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"i4y3d1y1", "[", 
    RowBox[{
    "row_", ",", "nN_", ",", "a_", ",", "b_", ",", "gfunc_", ",", " ", 
     "wfunc_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"grid", ",", "wgts", ",", "s", ",", "gN", ",", "p"}], "}"}], 
     ",", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gN", "=", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"Ceiling", "[", 
          RowBox[{"3", 
           RowBox[{"nN", "/", "2"}]}], "]"}], ",", "10"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"grid", "=", 
       RowBox[{"gfunc", "[", "gN", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"wgts", "=", 
       RowBox[{"wfunc", "[", "gN", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"s", "=", " ", 
       RowBox[{
        RowBox[{"dctnorm", "[", 
         RowBox[{"row", ",", "a", ",", "b"}], "]"}], 
        SuperscriptBox["a", "4"], 
        RowBox[{"Integrate", "[", 
         RowBox[{
          RowBox[{"y3dyTnab", "[", 
           RowBox[{"row", ",", "a", ",", "b", ",", " ", "x"}], "]"}], ",", 
          "x", ",", "x", ",", "x", ",", "x"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"p", "=", 
       RowBox[{"s", "/.", 
        RowBox[{"{", 
         RowBox[{"x", "->", "grid"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"VectorQ", "[", "p", "]"}]}], ",", 
        RowBox[{"p", "=", 
         RowBox[{"0", " ", "grid"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"s", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nN"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"s", "[", 
        RowBox[{"[", 
         RowBox[{"5", ";;"}], "]"}], "]"}], "=", 
       RowBox[{"ParallelTable", "[", 
        RowBox[{
         RowBox[{"Dot", "[", 
          RowBox[{
           RowBox[{"wgts", " ", 
            RowBox[{"Tnab", "[", 
             RowBox[{"i", ",", "a", ",", "b", ",", "grid"}], "]"}]}], ",", 
           "p"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "4", ",", 
           RowBox[{"nN", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "s"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"abSphere", "[", "riro_", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "ri", ",", "ro", ",", "sol", ",", "xixo"}], 
      "}"}], ",", 
     RowBox[{
      RowBox[{"sol", "=", 
       RowBox[{
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "a"}], "+", "b"}], "==", " ", "ri"}], " ", "&&", " ", 
          RowBox[{
           RowBox[{"a", "+", "b"}], "==", "ro"}], " ", "&&", " ", 
          RowBox[{
           FractionBox["ri", "ro"], " ", "==", "riro"}], " ", "&&", " ", 
          RowBox[{
           RowBox[{"ro", " ", "-", " ", "ri"}], " ", "==", " ", "1"}]}], 
         "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xixo", " ", "=", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ri", ",", "ro"}], "}"}], "/.", "sol"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<{xi,xo} -> \>\"", " ", "<>", " ", 
        RowBox[{"ToString", "[", 
         RowBox[{"xixo", "//", "N"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}], "/.", "sol"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dataroot", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{
      "quiccroot", ",", "\"\<Components\>\"", ",", "\"\<SparseSM\>\"", ",", 
       "\"\<TestSuite\>\""}], "}"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"datadir", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<_data\>\"", ",", "\"\<SparseSM\>\"", ",", "\"\<Chebyshev\>\"", ",", 
     "\"\<LinearMap\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"refdir", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<_refdata\>\"", ",", "\"\<SparseSM\>\"", ",", "\"\<Chebyshev\>\"", 
     ",", "\"\<LinearMap\>\""}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.78148875342758*^9, 3.781488863642158*^9}, {
   3.78148895707189*^9, 3.7814889573907623`*^9}, {3.781489029948645*^9, 
   3.7814890553640957`*^9}, {3.781489136285537*^9, 3.7814891932082443`*^9}, {
   3.78149303697103*^9, 3.781493122214035*^9}, {3.781493298461301*^9, 
   3.7814933270278482`*^9}, {3.7814935640115232`*^9, 3.781493570780239*^9}, {
   3.7814936070028563`*^9, 3.7814936754192247`*^9}, {3.781494195059642*^9, 
   3.781494261950231*^9}, {3.78149433242463*^9, 3.781494338774973*^9}, {
   3.7814943802568893`*^9, 3.7814943852474613`*^9}, {3.7814961066475563`*^9, 
   3.7814961153747807`*^9}, {3.78149617330755*^9, 3.781496177105639*^9}, {
   3.78149629659872*^9, 3.781496300873941*^9}, {3.781496391433565*^9, 
   3.7814963965715733`*^9}, {3.781496456848558*^9, 3.781496505405869*^9}, {
   3.781496540756978*^9, 3.781496544273192*^9}, {3.7814967192140417`*^9, 
   3.781496738201515*^9}, {3.7815017839659843`*^9, 3.781501786262987*^9}, {
   3.781501960227508*^9, 3.781501961259927*^9}, {3.781502080388815*^9, 
   3.781502090561513*^9}, {3.781502127094915*^9, 3.781502130106089*^9}, {
   3.7815029325471163`*^9, 3.781503079085352*^9}, {3.781503198092917*^9, 
   3.781503198212654*^9}, {3.781504744687633*^9, 3.7815048621048727`*^9}, {
   3.781506694300408*^9, 3.781506719993579*^9}, 3.7815072720850163`*^9, {
   3.781507327153521*^9, 3.7815073276157093`*^9}, {3.781509997057876*^9, 
   3.781510002498629*^9}, {3.781510153522806*^9, 3.781510211843845*^9}, 
   3.7815117617654657`*^9, {3.781522632803562*^9, 3.7815228643881483`*^9}, {
   3.7815229895731277`*^9, 3.7815229896683407`*^9}, {3.782115560498343*^9, 
   3.78211556109634*^9}, {3.785117725218185*^9, 3.7851177468895493`*^9}, {
   3.785117813045287*^9, 3.785117819505453*^9}, {3.785117870594225*^9, 
   3.785117933725362*^9}, {3.785117991376897*^9, 3.785118073891451*^9}, {
   3.7851205407111053`*^9, 3.785120578818956*^9}, {3.785120673864251*^9, 
   3.785120674286821*^9}, {3.785120749884001*^9, 3.785120751713105*^9}, 
   3.785120898190627*^9, {3.785121455670999*^9, 3.785121488827688*^9}, {
   3.785121537259901*^9, 3.78512157478738*^9}, {3.785121620578435*^9, 
   3.785121671830826*^9}, {3.785123108431879*^9, 3.7851231338341303`*^9}, {
   3.785123163950058*^9, 3.785123260812621*^9}, {3.7851233117107773`*^9, 
   3.785123337526918*^9}, {3.785123384043747*^9, 3.785123477092613*^9}, {
   3.78512352695505*^9, 3.785123670029067*^9}, {3.79430871567951*^9, 
   3.7943087179532433`*^9}, {3.7959419892182903`*^9, 3.795942212550314*^9}, {
   3.7959424056239367`*^9, 3.795942407060606*^9}, {3.795942611546982*^9, 
   3.7959426275439*^9}, {3.7959461675378513`*^9, 3.795946241496098*^9}, {
   3.795946722842165*^9, 3.795946773714357*^9}, {3.795946808229816*^9, 
   3.795946809153041*^9}, {3.796351305621257*^9, 3.796351439389214*^9}, {
   3.846294486617283*^9, 3.846294493536352*^9}, {3.8462945355413933`*^9, 
   3.846294557737678*^9}, {3.846294591612012*^9, 3.84629461451054*^9}, {
   3.8462946751905727`*^9, 3.846294709572811*^9}, 3.846298054465222*^9, {
   3.846298140370872*^9, 3.846298144014412*^9}, {3.8462981981786547`*^9, 
   3.8462982066955023`*^9}, {3.8463031111911287`*^9, 3.846303276950224*^9}, {
   3.846303366224491*^9, 3.846303373394088*^9}, {3.846303414181993*^9, 
   3.846303417907929*^9}, {3.846317185347789*^9, 3.8463171932611103`*^9}, {
   3.846319906497548*^9, 3.846319906633766*^9}, {3.846321463161354*^9, 
   3.8463214632971897`*^9}, {3.846750699939391*^9, 3.846750700823894*^9}, {
   3.848017574902307*^9, 3.8480175842887297`*^9}, {3.848018658923211*^9, 
   3.8480187281736937`*^9}, {3.848019093872747*^9, 3.848019107163273*^9}, {
   3.848019159898847*^9, 3.8480191631198463`*^9}, {3.8480195071367702`*^9, 
   3.848019527760607*^9}, {3.84802063419763*^9, 3.8480206538568907`*^9}, {
   3.848020684605953*^9, 3.848020686952752*^9}, {3.848020777539612*^9, 
   3.848020844882333*^9}, {3.848020885369279*^9, 3.8480209256015053`*^9}, {
   3.84802146276186*^9, 3.8480214651534843`*^9}, {3.848021758579526*^9, 
   3.848021771309462*^9}, {3.848021809804907*^9, 3.84802183051035*^9}, {
   3.848021881458268*^9, 3.8480218843928413`*^9}, 3.848021946041398*^9, {
   3.848022132369475*^9, 3.8480221494917517`*^9}, {3.848024426958679*^9, 
   3.848024458682569*^9}, {3.848024511461404*^9, 3.848024547109029*^9}, {
   3.848033160807172*^9, 3.8480331663260393`*^9}, {3.848040947870017*^9, 
   3.8480409638641977`*^9}, {3.8480411055869217`*^9, 3.848041213582592*^9}, {
   3.848041381831902*^9, 3.848041459511529*^9}, 3.8480423118135157`*^9, {
   3.848051765561474*^9, 3.848051773053854*^9}, {3.850992478492359*^9, 
   3.850992479053226*^9}, {3.856597055485635*^9, 3.8565970555993757`*^9}, {
   3.8565972560495243`*^9, 3.856597256912208*^9}, {3.856597460694787*^9, 
   3.856597461154623*^9}, {3.856601881723135*^9, 3.856601923389752*^9}, {
   3.8566021552256107`*^9, 3.856602163586714*^9}, {3.85660250617203*^9, 
   3.856602647871587*^9}, {3.8566026870030117`*^9, 3.856602693690131*^9}, {
   3.856603261090361*^9, 3.856603261440847*^9}, {3.856603359128941*^9, 
   3.856603416418457*^9}, {3.856606611879463*^9, 3.856606654705258*^9}, {
   3.8566071871342697`*^9, 3.8566072535658617`*^9}, {3.856607500859421*^9, 
   3.8566075039434977`*^9}, {3.856607664281458*^9, 3.8566076841423473`*^9}, {
   3.856608001046813*^9, 3.856608001214386*^9}, {3.856608070701721*^9, 
   3.856608072343639*^9}, {3.856608117449402*^9, 3.856608117561104*^9}, {
   3.856608196382683*^9, 3.856608211198258*^9}, {3.856608302992528*^9, 
   3.8566083055649*^9}, {3.856855229416007*^9, 3.85685524406502*^9}, {
   3.856855361344751*^9, 3.856855361463339*^9}, {3.85685605380376*^9, 
   3.856856054384613*^9}, {3.857009896710269*^9, 3.857009897336082*^9}, {
   3.857023779383348*^9, 3.857023787649867*^9}, {3.8570238223644333`*^9, 
   3.8570240061589537`*^9}, {3.857024654488708*^9, 3.857024695151787*^9}, {
   3.857024732811789*^9, 3.857024769003767*^9}, 3.85702484721039*^9, {
   3.857024892020961*^9, 3.857024893230722*^9}, {3.8570287045716257`*^9, 
   3.857028733522296*^9}, {3.85703058852365*^9, 3.8570306593019247`*^9}, {
   3.857030948104508*^9, 3.857031035945895*^9}, {3.8570313086509743`*^9, 
   3.857031420902648*^9}, {3.857031457614068*^9, 3.8570314653537407`*^9}, {
   3.857629915937607*^9, 3.8576299335812283`*^9}, {3.8576302636212397`*^9, 
   3.857630274198642*^9}, {3.8576303092152777`*^9, 3.8576303409077883`*^9}, {
   3.8576303763637447`*^9, 3.8576303845054903`*^9}, {3.857630602013941*^9, 
   3.857630607168433*^9}, {3.8576353743584747`*^9, 3.8576353944689703`*^9}, {
   3.863828767979496*^9, 3.8638288035749693`*^9}, {3.863828849793683*^9, 
   3.86382890815409*^9}, {3.86382894573596*^9, 3.8638289640621023`*^9}, {
   3.863829009151264*^9, 3.863829092984241*^9}, {3.8638293002724657`*^9, 
   3.86382930081421*^9}, {3.863829820731325*^9, 3.863829831502843*^9}, {
   3.863830018119137*^9, 3.863830018297452*^9}, {3.863830092069087*^9, 
   3.8638300953082848`*^9}, {3.863830526461545*^9, 3.863830550305381*^9}, {
   3.86383060307019*^9, 3.863830673739724*^9}, {3.863830703774048*^9, 
   3.8638308958924513`*^9}, {3.863830937172372*^9, 3.863830975394937*^9}, {
   3.863831207876645*^9, 3.8638312185511017`*^9}, {3.8638312507541*^9, 
   3.8638312634022923`*^9}, {3.8638312959692307`*^9, 3.86383130138624*^9}, {
   3.863831362508463*^9, 3.863831369379302*^9}, {3.863831483956224*^9, 
   3.86383149277776*^9}, {3.8638316145041428`*^9, 3.863831651321816*^9}, {
   3.8638317850325737`*^9, 3.863831789242489*^9}, {3.8638318263021193`*^9, 
   3.863831829503983*^9}, {3.8638336995900517`*^9, 3.863833811528911*^9}, {
   3.8638346629795113`*^9, 3.863834735225868*^9}, {3.8638348036484137`*^9, 
   3.863834803767107*^9}, {3.8638360976011333`*^9, 3.863836167687518*^9}, {
   3.863836231612904*^9, 3.863836234353065*^9}, {3.863836268127442*^9, 
   3.8638363103824377`*^9}, 3.863836363332224*^9, {3.8638371609428062`*^9, 
   3.8638371658191967`*^9}, {3.8638373633760157`*^9, 3.863837379440031*^9}, {
   3.863837419296606*^9, 3.8638374688868217`*^9}, {3.863837620714856*^9, 
   3.863837666221778*^9}, {3.863837928418453*^9, 3.863837930606831*^9}, {
   3.8638379613433113`*^9, 3.8638379649667997`*^9}, {3.863838002168187*^9, 
   3.863838088810183*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"596ae811-cce4-436d-bb23-76baa09df52f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"testOperator", "[", 
    RowBox[{
    "meta_", ",", "id_", ",", "opfunc_", ",", "gfunc_", ",", "wfunc_", ",", 
     "name_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"outprec", " ", "=", " ", "32"}], ",", "rows", ",", " ", 
       "cols", ",", " ", "a", ",", "b", ",", "ref", ",", "descr", ",", "msg", 
       ",", "tempmsg", ",", "fbase", ",", "fname"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rows", "=", 
       RowBox[{"meta", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cols", "=", 
       RowBox[{"meta", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"a", "=", 
       RowBox[{"meta", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"meta", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ref", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"opfunc", "[", 
           RowBox[{
           "j", ",", "rows", ",", "a", ",", "b", ",", "gfunc", ",", "wfunc"}],
            "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "0", ",", 
            RowBox[{"rows", "-", "1"}]}], "}"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ref", "=", 
       RowBox[{"SparseArray", "[", "ref", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"msg", "=", 
       RowBox[{
       "\"\<Exporting \>\"", "<>", "name", "<>", 
        "\"\< Chebyshev LinearMap operator of size \>\"", "<>", 
        RowBox[{"ToString", "[", "rows", "]"}], "<>", " ", "\"\< x \>\"", " ",
         "<>", 
        RowBox[{"ToString", "[", "cols", "]"}], "<>", "\"\< for a = \>\"", 
        " ", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"N", "[", "a", "]"}], "]"}], "<>", "\"\<, b = \>\"", " ", "<>",
         " ", 
        RowBox[{"ToString", "[", 
         RowBox[{"N", "[", "b", "]"}], "]"}], "<>", "\"\<...\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fbase", "=", 
       RowBox[{"name", "<>", "\"\<_id\>\"", "<>", 
        RowBox[{"ToString", "[", "id", "]"}]}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"fbase", " ", "=", " ", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<Sparse\>\"", ",", "fbase"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fname", "=", 
       RowBox[{"fbase", "<>", "\"\<_meta.dat\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"descr", "=", 
       RowBox[{"Flatten", "[", "meta", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"descr", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "=", 
       RowBox[{"N", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "a"}], "+", "b"}], ",", "outprec"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"descr", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "=", 
       RowBox[{"N", "[", 
        RowBox[{
         RowBox[{"a", "+", "b"}], ",", "outprec"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"descr", " ", "=", " ", 
       RowBox[{"Prepend", "[", 
        RowBox[{"descr", ",", 
         RowBox[{"Length", "@", "descr"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{"dataroot", ",", "refdir", ",", "fname"}], "}"}], "]"}], 
         "]"}], ",", "descr"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"fname", "=", 
       RowBox[{"fbase", "<>", "\"\<_ref.dat\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{"dataroot", ",", "refdir", ",", "fname"}], "}"}], "]"}], 
         "]"}], ",", "ref", ",", "\"\<MatrixMarket\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"Row", "[", 
        RowBox[{"{", 
         RowBox[{"msg", ",", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"\"\< Done(\>\"", "<>", 
             RowBox[{"DateString", "[", "]"}], "<>", "\"\<)\>\""}], ",", 
            RowBox[{"FontColor", "\[Rule]", "Green"}]}], "]"}]}], "}"}], 
        "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",\

 CellChangeTimes->CompressedData["
1:eJwdylsoQ3EAx/FDTLKSoiG5nAe0ZG+sFB2RlQ6S5BIPyoN5QCymiZFsI/dQ
hOaaSTaEmtQeaAwrLycZJeQyu7illji//8O3z8s3oaahuNafoqhYPqgSFzE6
g5NptjYRBxWnLLScSIth02dcKUzR0VUwfHyhBf6sTLbCp7cyL5Rnfv3C8j6/
oH7eioCzEMhyV5GQbrdFQ84nrIbZvgyidDb7FFoy94lr2jw7vBWtXsKN6Zpr
eLOrJO4dzNyT//D5BWpGU9zw+2KIeP7AKSVGJzPhGFDBpAg/zabZydj0Xh1M
dPQMw0hF4Q6UXS0dwbQRzg6381u+YfdcL3Gq/v4PsnQwZeRVjCYEQtcKFQQF
UpEQqm6yQmGnXhMFzYt1MZBLZeOhaYym4VAH5zbxqk2vHigU54Rt8Sa72ogy
QZ4Iurt8xOH5nxh499EYD132Phl818pZ+LjlKTFYncwxl14JJcu5aliw7iX+
A8FiE2I=
  "],
 CellLabel->"In[32]:=",ExpressionUUID->"d2252707-bca5-427e-bb0d-e866c6111559"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ab", " ", "=", " ", 
   RowBox[{"abSphere", "[", 
    FractionBox["7", "20"], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"meta", "=", 
   RowBox[{"{", 
    RowBox[{"10", ",", "10", ",", 
     RowBox[{"ab", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"ab", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"id", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "y1", ",", "chebgrid", ",", "chebweights", ",", 
    "\"\<Y1\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "y2", ",", "chebgrid", ",", "chebweights", ",", 
    "\"\<Y2\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "i1", ",", "chebgrid", ",", "chebweights", ",", 
    "\"\<I1\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "i2", ",", "chebgrid", ",", "chebweights", ",", 
    "\"\<I2\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "i2y1", ",", "chebgrid", ",", "chebweights", ",", 
    "\"\<I2Y1\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "i2y2", ",", "chebgrid", ",", "chebweights", ",", 
    "\"\<I2Y2\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "i2d1", ",", "chebgrid", ",", "chebweights", ",", 
    "\"\<I2D1\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "i2y1d1y1", ",", "chebgrid", ",", "chebweights", 
    ",", "\"\<I2Y1D1Y1\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "i3", ",", "chebgrid", ",", "chebweights", ",", 
    "\"\<I3\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "i4", ",", "chebgrid", ",", "chebweights", ",", 
    "\"\<I4\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "i4y3", ",", "chebgrid", ",", "chebweights", ",", 
    "\"\<I4Y3\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "i4d1", ",", "chebgrid", ",", "chebweights", ",", 
    "\"\<I4D1\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "i4y3d1y1", ",", "chebgrid", ",", "chebweights", 
    ",", "\"\<I4Y3D1Y1\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"ab", ",", " ", "meta", ",", " ", "id"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.857024968729545*^9, 3.8570250404005737`*^9}, {
  3.857029437453471*^9, 3.857029496399472*^9}, {3.8570297991469517`*^9, 
  3.8570298668602333`*^9}, {3.8570307018862886`*^9, 3.857030718346669*^9}, {
  3.857630590401149*^9, 3.85763059543819*^9}, {3.857630638651986*^9, 
  3.857630639760022*^9}, {3.8638292650020027`*^9, 3.863829266968472*^9}, {
  3.8638295276476183`*^9, 3.863829534715138*^9}, {3.863829582140546*^9, 
  3.8638296219762*^9}, {3.863830341087655*^9, 3.86383050639568*^9}, {
  3.86383393668358*^9, 3.863833943189124*^9}, {3.863834744832171*^9, 
  3.8638347485773497`*^9}, {3.8638377781074047`*^9, 3.8638377797798347`*^9}, {
  3.863838236091567*^9, 3.863838271376583*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"38f66280-530f-46f3-8e2d-4b2638d011d1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ab", " ", "=", " ", 
   RowBox[{"abSphere", "[", 
    FractionBox["7", "20"], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"meta", "=", 
   RowBox[{"{", 
    RowBox[{"21", ",", "21", ",", 
     RowBox[{"ab", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"ab", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"id", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "y1", ",", "chebgrid", ",", "chebweights", ",", 
    "\"\<Y1\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "y2", ",", "chebgrid", ",", "chebweights", ",", 
    "\"\<Y2\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "i1", ",", "chebgrid", ",", "chebweights", ",", 
    "\"\<I1\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "i2", ",", "chebgrid", ",", "chebweights", ",", 
    "\"\<I2\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "i2y1", ",", "chebgrid", ",", "chebweights", ",", 
    "\"\<I2Y1\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "i2y2", ",", "chebgrid", ",", "chebweights", ",", 
    "\"\<I2Y2\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "i2d1", ",", "chebgrid", ",", "chebweights", ",", 
    "\"\<I2D1\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "i2y1d1y1", ",", "chebgrid", ",", "chebweights", 
    ",", "\"\<I2Y1D1Y1\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "i3", ",", "chebgrid", ",", "chebweights", ",", 
    "\"\<I3\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "i4", ",", "chebgrid", ",", "chebweights", ",", 
    "\"\<I4\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "i4y3", ",", "chebgrid", ",", "chebweights", ",", 
    "\"\<I4Y3\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "i4d1", ",", "chebgrid", ",", "chebweights", ",", 
    "\"\<I4D1\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "i4y3d1y1", ",", "chebgrid", ",", "chebweights", 
    ",", "\"\<I4Y3D1Y1\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"ab", ",", " ", "meta", ",", " ", "id"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.857024968729545*^9, 3.8570250404005737`*^9}, {
  3.857029437453471*^9, 3.857029496399472*^9}, {3.8570297991469517`*^9, 
  3.8570298668602333`*^9}, {3.8570307018862886`*^9, 3.857030718346669*^9}, {
  3.857630590401149*^9, 3.85763059543819*^9}, {3.857630638651986*^9, 
  3.857630639760022*^9}, {3.8638292650020027`*^9, 3.863829266968472*^9}, {
  3.8638295276476183`*^9, 3.863829534715138*^9}, {3.863829582140546*^9, 
  3.8638296219762*^9}, {3.863830341087655*^9, 3.86383050639568*^9}, {
  3.86383393668358*^9, 3.863833943189124*^9}, {3.863834744832171*^9, 
  3.8638347485773497`*^9}, {3.8638377781074047`*^9, 3.8638377797798347`*^9}, {
  3.863838236091567*^9, 3.863838279554888*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"6609da65-ac7a-41fd-9d07-a08fbeb3a4fd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"meta", "=", 
   RowBox[{"{", 
    RowBox[{"10", ",", "10", ",", "1", ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"id", " ", "=", " ", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "y1", ",", "chebgrid", ",", "chebweights", ",", 
    "\"\<Y1\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "y2", ",", "chebgrid", ",", "chebweights", ",", 
    "\"\<Y2\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "i1", ",", "chebgrid", ",", "chebweights", ",", 
    "\"\<I1\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "i2", ",", "chebgrid", ",", "chebweights", ",", 
    "\"\<I2\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "i2y1", ",", "chebgrid", ",", "chebweights", ",", 
    "\"\<I2Y1\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "i2y2", ",", "chebgrid", ",", "chebweights", ",", 
    "\"\<I2Y2\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "i2d1", ",", "chebgrid", ",", "chebweights", ",", 
    "\"\<I2D1\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "i2y1d1y1", ",", "chebgrid", ",", "chebweights", 
    ",", "\"\<I2Y1D1Y1\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "i3", ",", "chebgrid", ",", "chebweights", ",", 
    "\"\<I3\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "i4", ",", "chebgrid", ",", "chebweights", ",", 
    "\"\<I4\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "i4y3", ",", "chebgrid", ",", "chebweights", ",", 
    "\"\<I4Y3\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "i4d1", ",", "chebgrid", ",", "chebweights", ",", 
    "\"\<I4D1\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "i4y3d1y1", ",", "chebgrid", ",", "chebweights", 
    ",", "\"\<I4Y3D1Y1\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"ab", ",", " ", "meta", ",", " ", "id"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.857024968729545*^9, 3.8570250404005737`*^9}, {
  3.857029437453471*^9, 3.857029496399472*^9}, {3.8570297991469517`*^9, 
  3.8570298668602333`*^9}, {3.8570307018862886`*^9, 3.857030718346669*^9}, {
  3.857630590401149*^9, 3.85763059543819*^9}, {3.857630638651986*^9, 
  3.857630639760022*^9}, {3.8638292650020027`*^9, 3.863829266968472*^9}, {
  3.8638295276476183`*^9, 3.863829534715138*^9}, {3.863829582140546*^9, 
  3.8638296219762*^9}, {3.863830341087655*^9, 3.86383050639568*^9}, {
  3.86383393668358*^9, 3.863833943189124*^9}, {3.863834744832171*^9, 
  3.8638347485773497`*^9}, {3.8638377781074047`*^9, 3.8638377797798347`*^9}, {
  3.863838236091567*^9, 3.863838271376583*^9}, {3.863838307830687*^9, 
  3.863838321968808*^9}, {3.863838385913822*^9, 3.8638383871817923`*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"eb2a6268-5818-4bd0-8b81-b7d2ece172d1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"meta", "=", 
   RowBox[{"{", 
    RowBox[{"21", ",", "21", ",", "1", ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"id", " ", "=", " ", "11"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "y1", ",", "chebgrid", ",", "chebweights", ",", 
    "\"\<Y1\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "y2", ",", "chebgrid", ",", "chebweights", ",", 
    "\"\<Y2\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "i1", ",", "chebgrid", ",", "chebweights", ",", 
    "\"\<I1\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "i2", ",", "chebgrid", ",", "chebweights", ",", 
    "\"\<I2\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "i2y1", ",", "chebgrid", ",", "chebweights", ",", 
    "\"\<I2Y1\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "i2y2", ",", "chebgrid", ",", "chebweights", ",", 
    "\"\<I2Y2\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "i2d1", ",", "chebgrid", ",", "chebweights", ",", 
    "\"\<I2D1\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "i2y1d1y1", ",", "chebgrid", ",", "chebweights", 
    ",", "\"\<I2Y1D1Y1\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "i3", ",", "chebgrid", ",", "chebweights", ",", 
    "\"\<I3\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "i4", ",", "chebgrid", ",", "chebweights", ",", 
    "\"\<I4\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "i4y3", ",", "chebgrid", ",", "chebweights", ",", 
    "\"\<I4Y3\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "i4d1", ",", "chebgrid", ",", "chebweights", ",", 
    "\"\<I4D1\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testOperator", "[", 
   RowBox[{
   "meta", ",", "id", ",", "i4y3d1y1", ",", "chebgrid", ",", "chebweights", 
    ",", "\"\<I4Y3D1Y1\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"ab", ",", " ", "meta", ",", " ", "id"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.857024968729545*^9, 3.8570250404005737`*^9}, {
  3.857029437453471*^9, 3.857029496399472*^9}, {3.8570297991469517`*^9, 
  3.8570298668602333`*^9}, {3.8570307018862886`*^9, 3.857030718346669*^9}, {
  3.857630590401149*^9, 3.85763059543819*^9}, {3.857630638651986*^9, 
  3.857630639760022*^9}, {3.8638292650020027`*^9, 3.863829266968472*^9}, {
  3.8638295276476183`*^9, 3.863829534715138*^9}, {3.863829582140546*^9, 
  3.8638296219762*^9}, {3.863830341087655*^9, 3.86383050639568*^9}, {
  3.86383393668358*^9, 3.863833943189124*^9}, {3.863834744832171*^9, 
  3.8638347485773497`*^9}, {3.8638377781074047`*^9, 3.8638377797798347`*^9}, {
  3.863838236091567*^9, 3.863838279554888*^9}, {3.86383839507743*^9, 
  3.863838409839361*^9}},
 CellLabel->"In[83]:=",ExpressionUUID->"ac1762c1-1f6b-4366-9064-afb31d8296ea"]
},
WindowSize->{605.4193548387096, 830.7096774193548},
WindowMargins->{{Automatic, 36.387096774193424`}, {
  Automatic, 21.978947368421053`}},
FrontEndVersion->"12.3 for Linux x86 (64-bit) (June 30, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"e3c1d7d5-1ad9-4b51-aac4-4707e7d47be3"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 45920, 1167, 4076, "Input",ExpressionUUID->"596ae811-cce4-436d-bb23-76baa09df52f"],
Cell[46481, 1189, 5269, 130, 619, "Input",ExpressionUUID->"d2252707-bca5-427e-bb0d-e866c6111559"],
Cell[51753, 1321, 3876, 93, 370, "Input",ExpressionUUID->"38f66280-530f-46f3-8e2d-4b2638d011d1"],
Cell[55632, 1416, 3876, 93, 370, "Input",ExpressionUUID->"6609da65-ac7a-41fd-9d07-a08fbeb3a4fd"],
Cell[59511, 1511, 3720, 87, 335, "Input",ExpressionUUID->"eb2a6268-5818-4bd0-8b81-b7d2ece172d1"],
Cell[63234, 1600, 3671, 87, 335, "Input",ExpressionUUID->"ac1762c1-1f6b-4366-9064-afb31d8296ea"]
}
]
*)

